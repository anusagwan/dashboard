{"ast":null,"code":"import _classCallCheck from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/user/generic-markdown-frontend/src/components/analyzePromo/promoAnalysis.js\";\nimport React, { Component } from 'react';\nimport DataTable from '../DataTable';\nimport WaterfallChart from '../WaterFallChart';\nimport './analyzePromoStyle.css';\nimport { OFFER_TYPE_OPTIONS } from '../../container/createNewPromo/constants';\nimport { isEqual } from 'lodash';\n\nvar PromoAnalysis =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PromoAnalysis, _Component);\n\n  function PromoAnalysis(props) {\n    var _this;\n\n    _classCallCheck(this, PromoAnalysis);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(PromoAnalysis).call(this, props));\n\n    _this.getHierarchyData = function (criteria) {\n      if (_this.props.currentPromo) {\n        var initialObj = {};\n        initialObj[\"baseline\".concat(criteria)] = 0;\n        initialObj[\"directIncremental\".concat(criteria)] = 0;\n        initialObj[\"halo\".concat(criteria)] = 0;\n        initialObj[\"cannibalization\".concat(criteria)] = 0;\n        initialObj[\"total\".concat(criteria)] = 0;\n\n        var consolidated = _this.props.currentPromo.hierarchies.reduce(function (sum, hierarchy) {\n          var sumObj = {};\n          sumObj[\"baseline\".concat(criteria)] = sum[\"baseline\".concat(criteria)] + (hierarchy.actual ? hierarchy.actual[\"baseline\".concat(criteria)] : hierarchy.simulation[\"baseline\".concat(criteria)]);\n          sumObj[\"directIncremental\".concat(criteria)] = sum[\"directIncremental\".concat(criteria)] + (hierarchy.actual ? hierarchy.actual[\"directIncremental\".concat(criteria)] : hierarchy.simulation[\"directIncremental\".concat(criteria)]);\n          sumObj[\"halo\".concat(criteria)] = sum[\"halo\".concat(criteria)] + (hierarchy.actual ? hierarchy.actual[\"halo\".concat(criteria)] : hierarchy.simulation[\"halo\".concat(criteria)]);\n          sumObj[\"cannibalization\".concat(criteria)] = sum[\"cannibalization\".concat(criteria)] + (hierarchy.actual ? hierarchy.actual[\"cannibalization\".concat(criteria)] : hierarchy.simulation[\"cannibalization\".concat(criteria)]);\n          sumObj[\"total\".concat(criteria)] = sum[\"total\".concat(criteria)] + (hierarchy.actual ? hierarchy.actual[\"total\".concat(criteria)] : hierarchy.simulation[\"total\".concat(criteria)]);\n          return sumObj;\n        }, initialObj);\n\n        var analysisData = [{\n          metric: 'Baseline',\n          value: consolidated[\"baseline\".concat(criteria)]\n        }, {\n          metric: 'Incremental',\n          value: consolidated[\"directIncremental\".concat(criteria)]\n        }, {\n          metric: 'Affinity',\n          value: consolidated[\"halo\".concat(criteria)]\n        }, {\n          metric: 'Cannibalization',\n          value: consolidated[\"cannibalization\".concat(criteria)]\n        }, {\n          metric: 'Pull Forward',\n          value: -(2 * consolidated[\"directIncremental\".concat(criteria)] / 100)\n        }, {\n          metric: 'Total',\n          value: consolidated[\"total\".concat(criteria)] ? consolidated[\"total\".concat(criteria)] : consolidated[\"baseline\".concat(criteria)] + consolidated[\"directIncremental\".concat(criteria)] + consolidated[\"halo\".concat(criteria)] + consolidated[\"cannibalization\".concat(criteria)] - 2 * consolidated[\"directIncremental\".concat(criteria)] / 100\n        }];\n        console.log(\"adfkjdsafljsadfsa\", _this.state.analysisData, analysisData);\n\n        _this.setState({\n          analysisData: analysisData,\n          selectedTab: criteria\n        });\n      }\n    };\n\n    _this.state = {\n      analysisData: [],\n      selectedTab: 'Margin'\n    };\n    _this.prefix = '$';\n    _this.postfix = '%';\n\n    _this.emptyValueFormatter = function (value) {\n      if (value.value) {\n        var toSting = Math.round(value.value);\n\n        if (value.value > 0) {\n          return toSting.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n        } else {\n          var splitAvalue = Math.abs(toSting);\n          return '-' + splitAvalue.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',') + '';\n        }\n      } else {\n        if (value.value === 0) {\n          return 0;\n        } else {\n          return '-';\n        }\n      }\n    };\n\n    _this.analysisMetrics = [{\n      headerName: 'Metric',\n      field: 'metric'\n    }, {\n      headerName: 'Value',\n      field: 'value',\n      valueFormatter: _this.emptyValueFormatter\n    }];\n    _this.colDefs = [{\n      headerName: 'Department',\n      sortable: true,\n      unSortIcon: true,\n      field: 'hierarchy.hierarchyLevel1'\n    }, {\n      headerName: 'Sub Department',\n      sortable: true,\n      unSortIcon: true,\n      field: 'hierarchy.hierarchyLevel2'\n    }, {\n      headerName: 'Category',\n      sortable: true,\n      unSortIcon: true,\n      field: 'hierarchy.hierarchyLevel3'\n    }, {\n      headerName: 'SKU/SKU Groups',\n      sortable: true,\n      unSortIcon: true,\n      field: 'hierarchy.hierarchyLevel4'\n    }];\n    return _this;\n  }\n\n  _createClass(PromoAnalysis, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getHierarchyData(this.state.selectedTab);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (!isEqual(prevProps.currentPromo, this.props.currentPromo)) {\n        this.getHierarchyData(this.state.selectedTab);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var analysisType = this.props.analysisType !== undefined ? this.props.analysisType : true;\n      console.log(\"sadfoa6fr98aw7tyer782w3r25343867254867\", this.state.analysisData);\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, analysisType && React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(\"hr\", {\n        className: \"mt-4 mb-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-md-8\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"font-size-14 font-bold\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, \"Basic Information\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"parameter-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, \"Promotion Name :\"), ' ', this.props.currentPromo.title), React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"parameter-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, \"Promotion Type : \"), OFFER_TYPE_OPTIONS.filter(function (type) {\n        return type.value === _this2.props.currentPromo.promoType;\n      })[0].label)), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"parameter-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, \"Campaign : \"), !!this.props.currentPromo.campaign && this.props.currentPromo.campaign.name), React.createElement(\"div\", {\n        className: \"col\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"parameter-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, \"Promotion Period :\"), this.props.currentPromo.startDate, \" to\", this.props.currentPromo.endDate)))), React.createElement(\"div\", {\n        className: \"vertical-separator-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"vertical-separator\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"col-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"font-size-14 font-bold\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, \"Parameters Information\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 214\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"parameter-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, \"Target Promotion value :\"), (this.props.currentPromo.promoType === 'A' || this.props.currentPromo.promoType === 'F') && this.prefix, String(Math.ceil(this.props.currentPromo.promoValue)).toLocaleString(), (this.props.currentPromo.promoType === 'BxGy' || this.props.currentPromo.promoType === 'P') && this.postfix)))), React.createElement(\"div\", {\n        className: \"sku-group-container mt-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"font-size-14 font-bold sku-group-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }, \"SKU/SKU Group\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, React.createElement(DataTable, {\n        rowData: this.props.currentPromo.hierarchies,\n        isSizetoFit: true,\n        columnDefs: this.colDefs,\n        style: {\n          height: '100px',\n          width: '100%',\n          margin: 'auto'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }))), React.createElement(\"hr\", {\n        className: \"mt-4 mb-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"font-size-14 font-bold\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }, \"Analysis\")), React.createElement(\"div\", {\n        className: analysisType ? 'row ' : 'row custom-model-historic',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-md-12 modal-promo-analys\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"btn-group analyze-promo-btn-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: this.state.selectedTab === 'Margin' ? 'btn btn-outline-primary btnModal1 active' : 'btn btn-outline-primary btnModal1',\n        onClick: function onClick() {\n          return _this2.getHierarchyData('Margin');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }, \"Margin\"), React.createElement(\"button\", {\n        className: this.state.selectedTab === 'Sales' ? 'btn btn-outline-primary btnModal1 active' : 'btn btn-outline-primary btnModal1',\n        onClick: function onClick() {\n          return _this2.getHierarchyData('Sales');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263\n        },\n        __self: this\n      }, \"Sales\"), React.createElement(\"button\", {\n        className: this.state.selectedTab === 'Units' ? 'btn btn-outline-primary btnModal1 active' : 'btn btn-outline-primary btnModal1',\n        onClick: function onClick() {\n          return _this2.getHierarchyData('Units');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273\n        },\n        __self: this\n      }, \"Units\"))), React.createElement(\"div\", {\n        className: \"col-md-6\",\n        style: {\n          marginBottom: '18px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285\n        },\n        __self: this\n      }, this.state.analysisData.length && React.createElement(WaterfallChart, {\n        selectedTab: this.state.selectedTab,\n        currentPromo: this.props.currentPromo,\n        analysisData: this.state.analysisData,\n        getHierarchyData: this.getHierarchyData,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"col-md-6 mb-10\",\n        style: {\n          marginBottom: '18px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          height: '100%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296\n        },\n        __self: this\n      }, React.createElement(DataTable, {\n        isSizetoFit: true,\n        columnDefs: this.analysisMetrics,\n        rowData: this.state.analysisData,\n        style: {\n          height: '100%',\n          width: '100%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return PromoAnalysis;\n}(Component);\n\nexport default PromoAnalysis;","map":{"version":3,"sources":["/home/user/generic-markdown-frontend/src/components/analyzePromo/promoAnalysis.js"],"names":["React","Component","DataTable","WaterfallChart","OFFER_TYPE_OPTIONS","isEqual","PromoAnalysis","props","getHierarchyData","criteria","currentPromo","initialObj","consolidated","hierarchies","reduce","sum","hierarchy","sumObj","actual","simulation","analysisData","metric","value","console","log","state","setState","selectedTab","prefix","postfix","emptyValueFormatter","toSting","Math","round","toString","replace","splitAvalue","abs","analysisMetrics","headerName","field","valueFormatter","colDefs","sortable","unSortIcon","prevProps","analysisType","undefined","title","filter","type","promoType","label","campaign","name","startDate","endDate","String","ceil","promoValue","toLocaleString","height","width","margin","marginBottom","length"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport DataTable from '../DataTable'\nimport WaterfallChart from '../WaterFallChart'\nimport './analyzePromoStyle.css'\nimport { OFFER_TYPE_OPTIONS } from '../../container/createNewPromo/constants'\nimport { isEqual } from 'lodash';\n\nclass PromoAnalysis extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      analysisData: [],\n      selectedTab: 'Margin'\n    }\n    this.prefix = '$'\n    this.postfix = '%'\n    this.emptyValueFormatter = value => {\n      if (value.value) {\n        var toSting = Math.round(value.value)\n        if (value.value > 0) {\n          return toSting.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')\n        } else {\n          var splitAvalue = Math.abs(toSting)\n          return (\n            '-' +\n            splitAvalue.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',') +\n            ''\n          )\n        }\n      } else {\n        if (value.value === 0) {\n          return 0\n        } else {\n          return '-'\n        }\n      }\n    }\n    this.analysisMetrics = [\n      {\n        headerName: 'Metric',\n        field: 'metric'\n      },\n      {\n        headerName: 'Value',\n        field: 'value',\n        valueFormatter: this.emptyValueFormatter\n      }\n    ]\n    this.colDefs = [\n      {\n        headerName: 'Department',\n        sortable: true,\n        unSortIcon: true,\n        field: 'hierarchy.hierarchyLevel1'\n      },\n      {\n        headerName: 'Sub Department',\n        sortable: true,\n        unSortIcon: true,\n        field: 'hierarchy.hierarchyLevel2'\n      },\n      {\n        headerName: 'Category',\n        sortable: true,\n        unSortIcon: true,\n        field: 'hierarchy.hierarchyLevel3'\n      },\n      {\n        headerName: 'SKU/SKU Groups',\n        sortable: true,\n        unSortIcon: true,\n        field: 'hierarchy.hierarchyLevel4'\n      }\n    ]\n  }\n\n  componentDidMount() {\n    this.getHierarchyData(this.state.selectedTab)\n  }\n  componentDidUpdate(prevProps) {\n    if (!isEqual(prevProps.currentPromo, this.props.currentPromo)) {\n      this.getHierarchyData(this.state.selectedTab)\n    }\n  }\n  getHierarchyData = criteria => {\n    if (this.props.currentPromo) {\n      let initialObj = {}\n      initialObj[`baseline${criteria}`] = 0\n      initialObj[`directIncremental${criteria}`] = 0\n      initialObj[`halo${criteria}`] = 0\n      initialObj[`cannibalization${criteria}`] = 0\n      initialObj[`total${criteria}`] = 0\n      let consolidated = this.props.currentPromo.hierarchies.reduce(\n        (sum, hierarchy) => {\n          let sumObj = {}\n          sumObj[`baseline${criteria}`] =\n            sum[`baseline${criteria}`] +\n            (hierarchy.actual\n              ? hierarchy.actual[`baseline${criteria}`]\n              : hierarchy.simulation[`baseline${criteria}`])\n          sumObj[`directIncremental${criteria}`] =\n            sum[`directIncremental${criteria}`] +\n            (hierarchy.actual\n              ? hierarchy.actual[`directIncremental${criteria}`]\n              : hierarchy.simulation[`directIncremental${criteria}`])\n          sumObj[`halo${criteria}`] =\n            sum[`halo${criteria}`] +\n            (hierarchy.actual\n              ? hierarchy.actual[`halo${criteria}`]\n              : hierarchy.simulation[`halo${criteria}`])\n          sumObj[`cannibalization${criteria}`] =\n            sum[`cannibalization${criteria}`] +\n            (hierarchy.actual\n              ? hierarchy.actual[`cannibalization${criteria}`]\n              : hierarchy.simulation[`cannibalization${criteria}`])\n          sumObj[`total${criteria}`] =\n            sum[`total${criteria}`] +\n            (hierarchy.actual\n              ? hierarchy.actual[`total${criteria}`]\n              : hierarchy.simulation[`total${criteria}`])\n          return sumObj\n        },\n        initialObj\n      )\n      let analysisData = [\n        {\n          metric: 'Baseline',\n          value: consolidated[`baseline${criteria}`]\n        },\n        {\n          metric: 'Incremental',\n          value: consolidated[`directIncremental${criteria}`]\n        },\n        {\n          metric: 'Affinity',\n          value: consolidated[`halo${criteria}`]\n        },\n        {\n          metric: 'Cannibalization',\n          value: consolidated[`cannibalization${criteria}`]\n        },\n        {\n          metric: 'Pull Forward',\n          value: -((2 * consolidated[`directIncremental${criteria}`]) / 100)\n        },\n        {\n          metric: 'Total',\n          value: consolidated[`total${criteria}`]\n            ? consolidated[`total${criteria}`] \n            : consolidated[`baseline${criteria}`] +\n              consolidated[`directIncremental${criteria}`] +\n              consolidated[`halo${criteria}`] +\n              consolidated[`cannibalization${criteria}`] -\n              (2 * consolidated[`directIncremental${criteria}`]) / 100\n        }\n      ]\n      console.log(\"adfkjdsafljsadfsa\", this.state.analysisData, analysisData)\n      this.setState({ analysisData, selectedTab: criteria })\n    }\n  }\n\n  render() {\n    var analysisType =\n      this.props.analysisType !== undefined ? this.props.analysisType : true\n      console.log(\"sadfoa6fr98aw7tyer782w3r25343867254867\", this.state.analysisData)\n    return (\n      <div>\n        {analysisType && (\n          <React.Fragment>\n            <hr className=\"mt-4 mb-4\"></hr>\n            <div className=\"row\">\n              <div className=\"col-md-8\">\n                <div className=\"font-size-14 font-bold\">Basic Information</div>\n                <div>\n                  <div className=\"row\">\n                    <div className=\"col\">\n                      <span className=\"parameter-label\">Promotion Name :</span>{' '}\n                      {this.props.currentPromo.title}\n                    </div>\n                    <div className=\"col\">\n                      <span className=\"parameter-label\">Promotion Type : </span>\n                      {\n                        OFFER_TYPE_OPTIONS.filter(\n                          type =>\n                            type.value === this.props.currentPromo.promoType\n                        )[0].label\n                      }\n                    </div>\n                  </div>\n                  <div className=\"row\">\n                    <div className=\"col\">\n                      <span className=\"parameter-label\">Campaign : </span>\n                      {!!this.props.currentPromo.campaign &&\n                        this.props.currentPromo.campaign.name}\n                    </div>\n                    <div className=\"col\">\n                      <span className=\"parameter-label\">\n                        Promotion Period :\n                      </span>\n                      {this.props.currentPromo.startDate} to\n                      {this.props.currentPromo.endDate}\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div className=\"vertical-separator-container\">\n                <div className=\"vertical-separator\"></div>\n              </div>\n              <div className=\"col-md-3\">\n                <div className=\"font-size-14 font-bold\">\n                  Parameters Information\n                </div>\n                <div>\n                  <div>\n                    <span className=\"parameter-label\">\n                      Target Promotion value :\n                    </span>\n                    {(this.props.currentPromo.promoType === 'A' ||\n                      this.props.currentPromo.promoType === 'F') &&\n                      this.prefix}\n                    {String(\n                      Math.ceil(this.props.currentPromo.promoValue)\n                    ).toLocaleString()}\n                    {(this.props.currentPromo.promoType === 'BxGy' ||\n                      this.props.currentPromo.promoType === 'P') &&\n                      this.postfix}\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className=\"sku-group-container mt-4\">\n              <div className=\"font-size-14 font-bold sku-group-header\">\n              SKU/SKU Group\n              </div>\n              <div>\n                <DataTable\n                  rowData={this.props.currentPromo.hierarchies}\n                  isSizetoFit={true}\n                  columnDefs={this.colDefs}\n                  style={{ height: '100px', width: '100%', margin: 'auto' }}\n                />\n              </div>\n            </div>\n\n            <hr className=\"mt-4 mb-4\"></hr>\n            <div className=\"font-size-14 font-bold\">Analysis</div>\n          </React.Fragment>\n        )}\n\n        <div className={analysisType ? 'row ' : 'row custom-model-historic'}>\n          <div className=\"col-md-12 modal-promo-analys\">\n            <div className=\"btn-group analyze-promo-btn-group\">\n              <button\n                className={\n                  this.state.selectedTab === 'Margin'\n                    ? 'btn btn-outline-primary btnModal1 active'\n                    : 'btn btn-outline-primary btnModal1'\n                }\n                onClick={() => this.getHierarchyData('Margin')}\n              >\n                Margin\n              </button>\n              <button\n                className={\n                  this.state.selectedTab === 'Sales'\n                    ? 'btn btn-outline-primary btnModal1 active'\n                    : 'btn btn-outline-primary btnModal1'\n                }\n                onClick={() => this.getHierarchyData('Sales')}\n              >\n                Sales\n              </button>\n              <button\n                className={\n                  this.state.selectedTab === 'Units'\n                    ? 'btn btn-outline-primary btnModal1 active'\n                    : 'btn btn-outline-primary btnModal1'\n                }\n                onClick={() => this.getHierarchyData('Units')}\n              >\n                Units\n              </button>\n            </div>\n          </div>\n          <div className=\"col-md-6\" style={{ marginBottom: '18px' }}>\n            {this.state.analysisData.length && (\n              <WaterfallChart\n                selectedTab={this.state.selectedTab}\n                currentPromo={this.props.currentPromo}\n                analysisData={this.state.analysisData}\n                getHierarchyData={this.getHierarchyData}\n              />\n            )}\n          </div>\n          <div className=\"col-md-6 mb-10\" style={{ marginBottom: '18px' }}>\n            <div style={{ height: '100%' }}>\n              <DataTable\n                isSizetoFit={true}\n                columnDefs={this.analysisMetrics}\n                rowData={this.state.analysisData}\n                style={{ height: '100%', width: '100%' }}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default PromoAnalysis\n"]},"metadata":{},"sourceType":"module"}