{"ast":null,"code":"import _regeneratorRuntime from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/user/generic-markdown-frontend/src/services/filters/index.js\";\nimport React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { labels } from './config';\nimport Select from '../select';\nimport './index.css';\nimport { connect } from 'react-redux';\nimport DateRangePicker from '../RetailCalendarDatePicker';\nimport FilterActions from '../../actions/filtersAction';\n\nvar Filters =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Filters, _Component);\n\n  function Filters(props) {\n    var _this;\n\n    _classCallCheck(this, Filters);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Filters).call(this, props));\n\n    _this.getHierarchyOptions = function (val, hierarchy) {\n      !Array.isArray(val) && (val = [val]);\n      var resetHierachies = {\n        stores: null\n      };\n\n      for (var i = hierarchy + 1; i <= _this.props.hierarchy.length; i++) {\n        resetHierachies[\"hierarchy\".concat(i)] = null;\n      }\n\n      _this.setState(_objectSpread(_defineProperty({}, \"hierarchy\".concat(hierarchy), val), resetHierachies),\n      /*#__PURE__*/\n      _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var func, req, _i;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return _this.props[\"setSelectedHierarchy\".concat(hierarchy)](val.map(function (e) {\n                  return e.label.replace(/'/g, \"''\");\n                }));\n\n              case 2:\n                func = hierarchy === 8 ? \"getStores\" : \"getHierarchyOptions\";\n                req = {};\n\n                for (_i = 1; _i <= hierarchy; _i++) {\n                  req[\"hierarchy\".concat(_i)] = _this.props[\"selectedHierarchy\".concat(_i)];\n                }\n\n                if (_this.props[func]) {\n                  if (Object.keys(req).length) {\n                    _this.props[func]({\n                      filters: req,\n                      hierarchyType: ('hierarchy' + (hierarchy + 1)).toUpperCase()\n                    });\n                  } else {\n                    _this.props[func]();\n                  }\n                }\n\n                _this.setState({\n                  filters: _objectSpread({}, req)\n                });\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      })));\n    };\n\n    _this.setDrop = function (val) {\n      var req = {};\n      var selItems = val.map(function (item) {\n        return item.label;\n      });\n      req['drop'] = selItems;\n\n      _this.setState({\n        filters: _objectSpread({}, req),\n        drops: val\n      }, function () {\n        _this.props.setSelectedDrops(val.map(function (v) {\n          return v.value;\n        }));\n      });\n    };\n\n    _this.setStores = function (val) {\n      var req = {};\n      var selItems = val.map(function (item) {\n        return item.label;\n      });\n      req['stores'] = selItems;\n\n      _this.setState({\n        filters: _objectSpread({}, req),\n        stores: val\n      }, function () {\n        _this.props.setSelectedStores(val.map(function (v) {\n          return v.value;\n        }));\n      });\n    };\n\n    _this.reset = function () {\n      _this.setState({\n        drops: null,\n        startDate: null,\n        endDate: null,\n        hierarchy1: null,\n        hierarchy2: null,\n        hierarchy3: null,\n        hierarchy4: null,\n        hierarchy5: null,\n        hierarchy6: null,\n        hierarchy7: null,\n        hierarchy8: null,\n        stores: null\n      }, function () {\n        _this.props.resetFilters();\n\n        _this.props.onReset && _this.props.onReset();\n      });\n    };\n\n    _this.onDatesChange = function (_ref2) {\n      var startDate = _ref2.startDate,\n          endDate = _ref2.endDate;\n\n      _this.setState({\n        startDate: startDate,\n        endDate: endDate\n      });\n\n      var weeks = [];\n\n      if (endDate) {\n        for (var i = startDate.week(); i <= endDate.week(); i++) {\n          weeks.push(i);\n        }\n      }\n\n      _this.props.setDateRange({\n        startDate: startDate && startDate.format('YYYY-MM-DD'),\n        endDate: endDate && endDate.format('YYYY-MM-DD'),\n        weeks: weeks\n      });\n    };\n\n    _this.state = {\n      filters: {},\n      startDate: null,\n      endDate: null,\n      hierarchy1: props.retainFilters && props.selectedHierarchy1 ? props.selectedHierarchy1.map(function (e) {\n        return {\n          value: e,\n          label: e\n        };\n      }) : null,\n      hierarchy2: props.retainFilters && props.selectedHierarchy2 ? props.selectedHierarchy2.map(function (e) {\n        return {\n          value: e,\n          label: e\n        };\n      }) : null,\n      hierarchy3: props.retainFilters && props.selectedHierarchy3 ? props.selectedHierarchy3.map(function (e) {\n        return {\n          value: e,\n          label: e\n        };\n      }) : null,\n      hierarchy4: props.retainFilters && props.selectedHierarchy4 ? props.selectedHierarchy4.map(function (e) {\n        return {\n          value: e,\n          label: e\n        };\n      }) : null,\n      hierarchy5: props.retainFilters && props.selectedHierarchy5 ? props.selectedHierarchy5.map(function (e) {\n        return {\n          value: e,\n          label: e\n        };\n      }) : null,\n      hierarchy6: props.retainFilters && props.selectedHierarchy6 ? props.selectedHierarchy6.map(function (e) {\n        return {\n          value: e,\n          label: e\n        };\n      }) : null,\n      hierarchy7: props.retainFilters && props.selectedHierarchy7 && props.location.state ? props.location.state.styles.map(function (e) {\n        return {\n          value: e,\n          label: e\n        };\n      }) : null,\n      hierarchy8: props.retainFilters && props.selectedHierarchy8 ? props.selectedHierarchy8.map(function (e) {\n        return {\n          value: e,\n          label: e\n        };\n      }) : null,\n      stores: props.retainFilters && props.selectedStores ? props.selectedStores.map(function (e) {\n        return {\n          value: e,\n          label: e\n        };\n      }) : null\n    };\n    props.getHierarchyOptions({\n      filters: {},\n      hierarchyType: 'HIERARCHY1'\n    });\n    props.getStores({\n      filters: {\n        hierarchy1: [],\n        hierarchy2: [],\n        hierarchy3: [],\n        hierarchy4: [],\n        hierarchy5: [],\n        hierarchy6: [],\n        hierarchy7: [],\n        hierarchy8: []\n      }\n    });\n\n    if (props.retainFilters && props.location.state) {\n      props.setSelectedHierarchy7(props.location.state.styles);\n      props.setSelectedStores(_this.state.stores.map(function (e) {\n        return e.label;\n      }));\n    }\n\n    props.setRetainFilters(false);\n    return _this;\n  }\n\n  _createClass(Filters, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.props.filterReset) {\n        this.props.filterResetHandler(false);\n        this.reset(); // reset filters from configFilters\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row ml-4 mr-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, this.props.drop && labels.drop && React.createElement(\"div\", {\n        className: \"col-md-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"mb-1 mt-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, labels.drop), React.createElement(Select, {\n        options: this.props.drops,\n        onChange: function onChange(option) {\n          return _this2.setDrop(option);\n        },\n        getOptionLabel: function getOptionLabel(option) {\n          return option.label + (option.year ? option.year : '');\n        },\n        value: this.state.drops,\n        isMulti: true // isDisabled={!this.props.drops || !this.props.drops.length}\n        ,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      })), this.props.hierarchy.map(function (filter, i) {\n        return labels[filter.type] && React.createElement(\"div\", {\n          className: \"col-md-2 \",\n          key: filter.type,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        }, React.createElement(\"label\", {\n          className: \"mb-1 mt-3\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 218\n          },\n          __self: this\n        }, labels[filter.type], filter.isMandatory ? React.createElement(\"span\", {\n          style: {\n            color: 'red'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }, \" * \") : null), React.createElement(Select, {\n          name: \"hierarchy\".concat(i + 1),\n          options: _this2.props[filter.type],\n          onChange: function onChange(option) {\n            return _this2.getHierarchyOptions(option, i + 1);\n          },\n          value: _this2.state[\"hierarchy\".concat(i + 1)],\n          isMulti: filter.isMultiple,\n          isDisabled: i === 0 && _this2.props.disableDivision ? true : false // isDisabled={!(this.state[`hierarchy${i}`] && this.state[`hierarchy${i}`].length)}\n          ,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        }));\n      }), this.props.stores && labels.store && !this.props.hideStoreCluster && React.createElement(\"div\", {\n        className: \"col-md-2 \",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"mb-1 mt-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, labels.store, !this.props.storeIsNotMandatory ? React.createElement(\"span\", {\n        style: {\n          color: 'red'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, \" * \") : null), React.createElement(Select, {\n        options: this.props.stores,\n        onChange: function onChange(option) {\n          return _this2.setStores(option);\n        },\n        value: this.state.stores,\n        isMulti: true // isDisabled={!(this.state[`hierarchy${i}`] && this.state[`hierarchy${i}`].length)}\n        ,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      })), this.props.dateRange && React.createElement(\"div\", {\n        className: \"col-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        className: \"mb-1 mt-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, \"Date range \", React.createElement(\"span\", {\n        style: {\n          color: 'red'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }, \" * \")), React.createElement(DateRangePicker, {\n        startDate: this.state.startDate,\n        startDateId: \"startDate_11\",\n        endDate: this.state.endDate,\n        endDateId: \"endDate_11\",\n        onDatesChange: this.onDatesChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      })), !this.props.hidefilterButton && React.createElement(\"div\", {\n        className: this.props.from === 'styleGroupConfig' ? 'col-md-2 mt-5 px-0 text-center' : 'col-md-3 mt-5',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: function onClick() {\n          return _this2.props.onFilter({\n            filters: _this2.state.filters,\n            startDate: _this2.state.startDate,\n            endDate: _this2.state.endDate\n          });\n        },\n        className: this.props.from === 'styleGroupConfig' ? 'btn btn-primary btn-filter' : 'col-md-4 btn btn-primary btn-filter',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-filter\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284\n        },\n        __self: this\n      }), \"\\xA0 Filter\")), React.createElement(\"button\", {\n        className: this.props.from === 'styleGroupConfig' ? 'offset-1 btn btn-primary btn-filter btn-filter-reset' : 'col-md-4 offset-1 btn btn-primary btn-filter btn-filter-reset',\n        onClick: this.reset,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 294\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"fa fa-repeat\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295\n        },\n        __self: this\n      }), \"\\xA0 Reset\")))));\n    }\n  }]);\n\n  return Filters;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    drops: store.filtersReducer.drops,\n    selectedDrops: store.filtersReducer.selectedDrops,\n    hierarchy1: store.filtersReducer.hierarchy1,\n    selectedHierarchy1: store.filtersReducer.selectedHierarchy1,\n    hierarchy2: store.filtersReducer.hierarchy2,\n    selectedHierarchy2: store.filtersReducer.selectedHierarchy2,\n    hierarchy3: store.filtersReducer.hierarchy3,\n    selectedHierarchy3: store.filtersReducer.selectedHierarchy3,\n    hierarchy4: store.filtersReducer.hierarchy4,\n    selectedHierarchy4: store.filtersReducer.selectedHierarchy4,\n    hierarchy5: store.filtersReducer.hierarchy5,\n    selectedHierarchy5: store.filtersReducer.selectedHierarchy5,\n    hierarchy6: store.filtersReducer.hierarchy6,\n    selectedHierarchy6: store.filtersReducer.selectedHierarchy6,\n    hierarchy7: store.filtersReducer.hierarchy7,\n    selectedHierarchy7: store.filtersReducer.selectedHierarchy7,\n    hierarchy8: store.filtersReducer.hierarchy8,\n    selectedHierarchy8: store.filtersReducer.selectedHierarchy8,\n    stores: store.filtersReducer.stores,\n    selectedStores: store.filtersReducer.selectedStores,\n    startDate: store.filtersReducer.startDate,\n    endDate: store.filtersReducer.endDate,\n    weeks: store.filtersReducer.weeks,\n    retainFilters: store.filtersReducer.retainFilters\n  };\n};\n\nvar mapDispatchToProps = {\n  getHierarchyOptions: FilterActions.getHierarchyOptions,\n  getStores: FilterActions.getStores,\n  setSelectedDrops: FilterActions.setSelectedDrops,\n  setSelectedHierarchy1: FilterActions.setSelectedHierarchy1,\n  setSelectedHierarchy2: FilterActions.setSelectedHierarchy2,\n  setSelectedHierarchy3: FilterActions.setSelectedHierarchy3,\n  setSelectedHierarchy4: FilterActions.setSelectedHierarchy4,\n  setSelectedHierarchy5: FilterActions.setSelectedHierarchy5,\n  setSelectedHierarchy6: FilterActions.setSelectedHierarchy6,\n  setSelectedHierarchy7: FilterActions.setSelectedHierarchy7,\n  setSelectedHierarchy8: FilterActions.setSelectedHierarchy8,\n  setSelectedStores: FilterActions.setSelectedStores,\n  setDateRange: FilterActions.setDateRange,\n  resetFilters: FilterActions.resetFilters,\n  setRetainFilters: FilterActions.setRetainFilters\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Filters));","map":{"version":3,"sources":["/home/user/generic-markdown-frontend/src/services/filters/index.js"],"names":["React","Component","withRouter","labels","Select","connect","DateRangePicker","FilterActions","Filters","props","getHierarchyOptions","val","hierarchy","Array","isArray","resetHierachies","stores","i","length","setState","map","e","label","replace","func","req","Object","keys","filters","hierarchyType","toUpperCase","setDrop","selItems","item","drops","setSelectedDrops","v","value","setStores","setSelectedStores","reset","startDate","endDate","hierarchy1","hierarchy2","hierarchy3","hierarchy4","hierarchy5","hierarchy6","hierarchy7","hierarchy8","resetFilters","onReset","onDatesChange","weeks","week","push","setDateRange","format","state","retainFilters","selectedHierarchy1","selectedHierarchy2","selectedHierarchy3","selectedHierarchy4","selectedHierarchy5","selectedHierarchy6","selectedHierarchy7","location","styles","selectedHierarchy8","selectedStores","getStores","setSelectedHierarchy7","setRetainFilters","prevProps","prevState","filterReset","filterResetHandler","drop","option","year","filter","type","isMandatory","color","isMultiple","disableDivision","store","hideStoreCluster","storeIsNotMandatory","dateRange","hidefilterButton","from","onFilter","mapStateToProps","filtersReducer","selectedDrops","mapDispatchToProps","setSelectedHierarchy1","setSelectedHierarchy2","setSelectedHierarchy3","setSelectedHierarchy4","setSelectedHierarchy5","setSelectedHierarchy6","setSelectedHierarchy8"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { labels } from './config';\nimport Select from '../select';\nimport './index.css';\nimport { connect } from 'react-redux';\nimport DateRangePicker from '../RetailCalendarDatePicker';\nimport FilterActions from '../../actions/filtersAction';\n\nclass Filters extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      filters: {},\n      startDate: null,\n      endDate: null,\n      hierarchy1:\n        props.retainFilters && props.selectedHierarchy1\n          ? props.selectedHierarchy1.map((e) => {\n              return { value: e, label: e };\n            })\n          : null,\n      hierarchy2:\n        props.retainFilters && props.selectedHierarchy2\n          ? props.selectedHierarchy2.map((e) => {\n              return { value: e, label: e };\n            })\n          : null,\n      hierarchy3:\n        props.retainFilters && props.selectedHierarchy3\n          ? props.selectedHierarchy3.map((e) => {\n              return { value: e, label: e };\n            })\n          : null,\n      hierarchy4:\n        props.retainFilters && props.selectedHierarchy4\n          ? props.selectedHierarchy4.map((e) => {\n              return { value: e, label: e };\n            })\n          : null,\n      hierarchy5:\n        props.retainFilters && props.selectedHierarchy5\n          ? props.selectedHierarchy5.map((e) => {\n              return { value: e, label: e };\n            })\n          : null,\n      hierarchy6:\n        props.retainFilters && props.selectedHierarchy6\n          ? props.selectedHierarchy6.map((e) => {\n              return { value: e, label: e };\n            })\n          : null,\n      hierarchy7:\n        props.retainFilters && props.selectedHierarchy7 && props.location.state\n          ? props.location.state.styles.map((e) => {\n              return { value: e, label: e };\n            })\n          : null,\n      hierarchy8:\n        props.retainFilters && props.selectedHierarchy8\n          ? props.selectedHierarchy8.map((e) => {\n              return { value: e, label: e };\n            })\n          : null,\n      stores:\n        props.retainFilters && props.selectedStores\n          ? props.selectedStores.map((e) => {\n              return { value: e, label: e };\n            })\n          : null,\n    };\n    props.getHierarchyOptions({ filters: {}, hierarchyType: 'HIERARCHY1' });\n    props.getStores({\n      filters: {\n        hierarchy1: [],\n        hierarchy2: [],\n        hierarchy3: [],\n        hierarchy4: [],\n        hierarchy5: [],\n        hierarchy6: [],\n        hierarchy7: [],\n        hierarchy8: [],\n      },\n    });\n    if (props.retainFilters && props.location.state) {\n      props.setSelectedHierarchy7(props.location.state.styles);\n      props.setSelectedStores(this.state.stores.map((e) => e.label));\n    }\n    props.setRetainFilters(false);\n  }\n  componentDidUpdate(prevProps, prevState) {\n    if (this.props.filterReset) {\n      this.props.filterResetHandler(false);\n      this.reset(); // reset filters from configFilters\n    }\n  }\n  getHierarchyOptions = (val, hierarchy) => {\n    !Array.isArray(val) && (val = [val]);\n    let resetHierachies = { stores: null };\n    for (let i = hierarchy + 1; i <= this.props.hierarchy.length; i++) {\n      resetHierachies[`hierarchy${i}`] = null;\n    }\n    this.setState({ [`hierarchy${hierarchy}`]: val, ...resetHierachies }, async () => {\n      await this.props[`setSelectedHierarchy${hierarchy}`](\n        val.map((e) => e.label.replace(/'/g, \"''\"))\n      );\n      let func = hierarchy === 8 ? `getStores` : `getHierarchyOptions`;\n      let req = {};\n\n      for (let i = 1; i <= hierarchy; i++) {\n        req[`hierarchy${i}`] = this.props[`selectedHierarchy${i}`];\n      }\n      if (this.props[func]) {\n        if (Object.keys(req).length) {\n          this.props[func]({\n            filters: req,\n            hierarchyType: ('hierarchy' + (hierarchy + 1)).toUpperCase(),\n          });\n        } else {\n          this.props[func]();\n        }\n      }\n      this.setState({ filters: { ...req } });\n    });\n  };\n  setDrop = (val) => {\n    let req = {};\n    let selItems = val.map((item) => item.label);\n    req['drop'] = selItems;\n    this.setState({ filters: { ...req }, drops: val }, () => {\n      this.props.setSelectedDrops(val.map((v) => v.value));\n    });\n  };\n  setStores = (val) => {\n    let req = {};\n    let selItems = val.map((item) => item.label);\n    req['stores'] = selItems;\n    this.setState({ filters: { ...req }, stores: val }, () => {\n      this.props.setSelectedStores(val.map((v) => v.value));\n    });\n  };\n  reset = () => {\n    this.setState(\n      {\n        drops: null,\n        startDate: null,\n        endDate: null,\n        hierarchy1: null,\n        hierarchy2: null,\n        hierarchy3: null,\n        hierarchy4: null,\n        hierarchy5: null,\n        hierarchy6: null,\n        hierarchy7: null,\n        hierarchy8: null,\n        stores: null,\n      },\n      () => {\n        this.props.resetFilters();\n        this.props.onReset && this.props.onReset();\n      }\n    );\n  };\n  onDatesChange = ({ startDate, endDate }) => {\n    this.setState({\n      startDate,\n      endDate,\n    });\n    let weeks = [];\n    if (endDate) {\n      for (let i = startDate.week(); i <= endDate.week(); i++) {\n        weeks.push(i);\n      }\n    }\n    this.props.setDateRange({\n      startDate: startDate && startDate.format('YYYY-MM-DD'),\n      endDate: endDate && endDate.format('YYYY-MM-DD'),\n      weeks,\n    });\n  };\n  render() {\n    return (\n      <React.Fragment>\n        <div className=\"row ml-4 mr-4\">\n          {this.props.drop && labels.drop && (\n            <div className=\"col-md-2\">\n              <label className=\"mb-1 mt-3\">{labels.drop}</label>\n              <Select\n                options={this.props.drops}\n                onChange={(option) => this.setDrop(option)}\n                getOptionLabel={(option) => option.label + (option.year ? option.year : '')}\n                value={this.state.drops}\n                isMulti\n                // isDisabled={!this.props.drops || !this.props.drops.length}\n              />\n            </div>\n          )}\n          {/* {this.props.hierarchy.map(\n            (filter, i) =>\n              labels[filter] && (\n                <div className=\"col-md-2 \" key={filter}>\n                  <label className=\"mb-1 mt-3\">{labels[filter]}</label>\n                  <Select\n                    options={this.props[filter]}\n                    onChange={(option) => this.getHierarchyOptions(option, i + 1)}\n                    value={this.state[`hierarchy${i + 1}`]}\n                    isMulti\n                    allowSelectAll\n                    // isDisabled={!(this.state[`hierarchy${i}`] && this.state[`hierarchy${i}`].length)}\n                  />\n                </div>\n              )\n          )} */}\n          {this.props.hierarchy.map(\n            (filter, i) =>\n              labels[filter.type] && (\n                <div className=\"col-md-2 \" key={filter.type}>\n                  <label className=\"mb-1 mt-3\">\n                    {labels[filter.type]}\n                    {filter.isMandatory ? <span style={{ color: 'red' }}> * </span> : null}\n                  </label>\n                  <Select\n                    name={`hierarchy${i + 1}`}\n                    options={this.props[filter.type]}\n                    onChange={(option) => this.getHierarchyOptions(option, i + 1)}\n                    value={this.state[`hierarchy${i + 1}`]}\n                    isMulti={filter.isMultiple}\n                    isDisabled={i === 0 && this.props.disableDivision ? true : false}\n                    // isDisabled={!(this.state[`hierarchy${i}`] && this.state[`hierarchy${i}`].length)}\n                  />\n                </div>\n              )\n          )}\n          {this.props.stores && labels.store && !this.props.hideStoreCluster && (\n            <div className=\"col-md-2 \">\n              <label className=\"mb-1 mt-3\">\n                {labels.store}\n                {!this.props.storeIsNotMandatory ? <span style={{ color: 'red' }}> * </span> : null}\n              </label>\n              <Select\n                options={this.props.stores}\n                onChange={(option) => this.setStores(option)}\n                value={this.state.stores}\n                isMulti\n                // isDisabled={!(this.state[`hierarchy${i}`] && this.state[`hierarchy${i}`].length)}\n              />\n            </div>\n          )}\n          {this.props.dateRange && (\n            <div className=\"col-md-3\">\n              <label className=\"mb-1 mt-3\">\n                Date range <span style={{ color: 'red' }}> * </span>\n              </label>\n              <DateRangePicker\n                startDate={this.state.startDate}\n                startDateId=\"startDate_11\"\n                endDate={this.state.endDate}\n                endDateId=\"endDate_11\"\n                onDatesChange={this.onDatesChange}\n              />\n            </div>\n          )}\n          {!this.props.hidefilterButton && (\n            <div\n              className={\n                this.props.from === 'styleGroupConfig'\n                  ? 'col-md-2 mt-5 px-0 text-center'\n                  : 'col-md-3 mt-5'\n              }>\n              <button\n                onClick={() =>\n                  this.props.onFilter({\n                    filters: this.state.filters,\n                    startDate: this.state.startDate,\n                    endDate: this.state.endDate,\n                  })\n                }\n                className={\n                  this.props.from === 'styleGroupConfig'\n                    ? 'btn btn-primary btn-filter'\n                    : 'col-md-4 btn btn-primary btn-filter'\n                }>\n                <span>\n                  <i className=\"fa fa-filter\"></i>&nbsp; Filter\n                </span>\n              </button>\n              <button\n                className={\n                  this.props.from === 'styleGroupConfig'\n                    ? 'offset-1 btn btn-primary btn-filter btn-filter-reset'\n                    : 'col-md-4 offset-1 btn btn-primary btn-filter btn-filter-reset'\n                }\n                onClick={this.reset}>\n                <span>\n                  <i className=\"fa fa-repeat\"></i>&nbsp; Reset\n                </span>\n              </button>\n            </div>\n          )}\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = (store) => {\n  return {\n    drops: store.filtersReducer.drops,\n    selectedDrops: store.filtersReducer.selectedDrops,\n    hierarchy1: store.filtersReducer.hierarchy1,\n    selectedHierarchy1: store.filtersReducer.selectedHierarchy1,\n    hierarchy2: store.filtersReducer.hierarchy2,\n    selectedHierarchy2: store.filtersReducer.selectedHierarchy2,\n    hierarchy3: store.filtersReducer.hierarchy3,\n    selectedHierarchy3: store.filtersReducer.selectedHierarchy3,\n    hierarchy4: store.filtersReducer.hierarchy4,\n    selectedHierarchy4: store.filtersReducer.selectedHierarchy4,\n    hierarchy5: store.filtersReducer.hierarchy5,\n    selectedHierarchy5: store.filtersReducer.selectedHierarchy5,\n    hierarchy6: store.filtersReducer.hierarchy6,\n    selectedHierarchy6: store.filtersReducer.selectedHierarchy6,\n    hierarchy7: store.filtersReducer.hierarchy7,\n    selectedHierarchy7: store.filtersReducer.selectedHierarchy7,\n    hierarchy8: store.filtersReducer.hierarchy8,\n    selectedHierarchy8: store.filtersReducer.selectedHierarchy8,\n    stores: store.filtersReducer.stores,\n    selectedStores: store.filtersReducer.selectedStores,\n    startDate: store.filtersReducer.startDate,\n    endDate: store.filtersReducer.endDate,\n    weeks: store.filtersReducer.weeks,\n    retainFilters: store.filtersReducer.retainFilters,\n  };\n};\nconst mapDispatchToProps = {\n  getHierarchyOptions: FilterActions.getHierarchyOptions,\n  getStores: FilterActions.getStores,\n  setSelectedDrops: FilterActions.setSelectedDrops,\n  setSelectedHierarchy1: FilterActions.setSelectedHierarchy1,\n  setSelectedHierarchy2: FilterActions.setSelectedHierarchy2,\n  setSelectedHierarchy3: FilterActions.setSelectedHierarchy3,\n  setSelectedHierarchy4: FilterActions.setSelectedHierarchy4,\n  setSelectedHierarchy5: FilterActions.setSelectedHierarchy5,\n  setSelectedHierarchy6: FilterActions.setSelectedHierarchy6,\n  setSelectedHierarchy7: FilterActions.setSelectedHierarchy7,\n  setSelectedHierarchy8: FilterActions.setSelectedHierarchy8,\n  setSelectedStores: FilterActions.setSelectedStores,\n  setDateRange: FilterActions.setDateRange,\n  resetFilters: FilterActions.resetFilters,\n  setRetainFilters: FilterActions.setRetainFilters,\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(Filters));\n"]},"metadata":{},"sourceType":"module"}