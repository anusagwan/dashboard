{"ast":null,"code":"import _taggedTemplateLiteral from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _toConsumableArray from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/user/generic-markdown-frontend/src/components/Summary/Summary.js\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: row;\\n  justify-content: space-between;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport Filters from '../../services/filters';\nimport './summaryStyle.css';\nimport styled from 'styled-components';\nimport LoadingOverlay from '../../utils/Loader';\nimport NoData from '../noTableData';\nimport SummaryAction from '../../actions/summaryAction';\nimport plannedReportsAction from '../../actions/plannedReportsAction';\nimport manuallyCreateMdActions from '../../actions/manuallyCreateMdActions.js';\nimport { aggColDef, binToWeekColDef, weekToBinColDef, detailedColDef } from './aggColdef';\nimport _ from 'lodash';\nimport DataTable from '../../services/reactTable';\nimport ColumnSelection from '../columnSelection';\nimport moment from 'moment';\nimport card1Image from '../../images/card1Image.png';\nimport card2Image from '../../images/card2Image.png';\nimport card3Image from '../../images/card3Image.png';\nimport card4Image from '../../images/card4Image.png';\nimport Switch from '../../services/toggleSwitch';\nimport CardComponent from '../../services/cardComponent/cardComponent';\nimport filterActions from '../../actions/filtersAction';\nimport IndeterminateCheckbox from '../../components/cellRenders/inderterminateCheckbox';\nimport { toPercentageMultipliedByHundred, toUnit, toDollar } from '../../helper/formatter';\n\nvar Summary =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Summary, _Component);\n\n  function Summary() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Summary);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Summary)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      switchedPlans: false,\n      //default aggregated view\n      textStr: 'Please select filters to show Markdown plans',\n      // firstCardText: 'KPIs to be decided',\n      firstCardFirstValue: '12%',\n      firstCardSecondValue: '24%',\n      secondCardFirstValue: '16%',\n      secondCardSecondValue: '20%',\n      thirdCardFirstValue: '6%',\n      thirdCardSecondValue: '10%',\n      fourthCardFirstValue: '345',\n      fourthCardSecondValue: '3,457',\n      cardWeekText: 'LW',\n      cardMonthText: 'TW',\n      cardTotalText: 'Total',\n      selectedRows: [],\n      selectedItems: [{\n        label: 'Margin %',\n        value: 'margin_perc',\n        //for subcomponents\n        overall: 'overall_margin_perc',\n        //for main table(agg-parent)\n        detailed: 'week_level_margin_perc' //for detailed table\n\n      }],\n      columnOptions: [{\n        label: 'Margin %',\n        value: 'margin_perc',\n        overall: 'overall_margin_perc',\n        detailed: 'week_level_margin_perc'\n      }, {\n        label: 'Margin $',\n        value: 'margin$',\n        overall: 'overall_margin$',\n        detailed: 'week_level_margin$'\n      }, {\n        label: 'AUM $',\n        value: 'aum',\n        overall: 'overall_aum',\n        detailed: 'week_level_aum'\n      }, {\n        label: 'Revenue $',\n        value: 'revenue$',\n        overall: 'overall_revenue$',\n        detailed: 'week_level_revenue$'\n      }, // {\n      //   label: 'Planned units',\n      //   value: 'planned_units',\n      //   overall: 'overall_planned_units',\n      //   detailed: 'week_level_planned_units',\n      // },\n      {\n        label: 'Markdown units',\n        value: 'markdown_units',\n        overall: 'overall_markdown_units',\n        detailed: 'week_level_markdown_units'\n      }, {\n        label: 'AUR $',\n        value: 'aur',\n        overall: 'overall_aur',\n        detailed: 'week_level_aur'\n      }],\n      selLabels: ['Margin', 'Sales'],\n      columns: [],\n      aggColDef: [],\n      weekToBinColDef: [],\n      binToWeekColDef: [],\n      tableData: [],\n      showKPIS: false,\n      expandedRowDetails: [],\n      pageNum: 1,\n      KPILoader: false,\n      tableLoader: false,\n      planDetails: {}\n    };\n\n    _this.findStatusColor = function (status, color) {\n      switch (status) {\n        case 'high':\n          return color.high;\n\n        case 'medium':\n          return color.medium;\n\n        case 'low':\n          return color.low;\n\n        default:\n          break;\n      }\n    };\n\n    _this.bgmCol = function (cellInfo) {\n      if (cellInfo.column.id === 'md_status') var status = cellInfo.row.original.md_status;\n      var bgCol = {\n        high: '#F8E8E8',\n        medium: '#FCF3D1',\n        low: '#E8F8F5'\n      };\n      return _this.findStatusColor(status, bgCol);\n    };\n\n    _this.txtCol = function (cellInfo) {\n      if (cellInfo.column.id === 'md_status') var status = cellInfo.row.original.md_status;\n      var txtCol = {\n        high: '#D38485',\n        medium: '#F0C53A',\n        low: '#66CFBA'\n      };\n      return _this.findStatusColor(status, txtCol);\n    };\n\n    _this.metricHandler = function (columns, selOptions, val) {\n      // val=detailed for detailed table, val=overall for agg-parent col and val=value for subcomponent cols\n      var headers = _.cloneDeep(columns);\n\n      _.remove(headers, function (item) {\n        return item.metric || item.hideColumn;\n      }); //removing metric:true and hideColumn: true cols\n\n\n      _.forEach(selOptions, function (item) {\n        var newTableCols = _.filter(headers, function (a) {\n          return a.accessor === item[val];\n        });\n\n        var found = _.find(columns, {\n          accessor: item[val]\n        });\n\n        if (newTableCols.length == 0) {\n          var spliceAt = headers.length - 0; //modify here if the new col needs to be added at a specific index\n\n          headers.splice(spliceAt, 0, found);\n        }\n      });\n\n      return headers;\n    };\n\n    _this.onHandleSelect = function (selOptions) {\n      var headers, weekToBinHeader, binToWeekHeader;\n\n      if (_this.state.switchedPlans) {\n        //detailed table case\n        headers = _this.metricHandler(detailedColDef, selOptions, 'detailed');\n\n        _this.setState({\n          columns: headers,\n          selectedItems: selOptions\n        });\n      } else {\n        //agg-table case: needs to update 3 coldefs,\n        //imported coldefs already has all of the required columns,\n        //we are just filtering out needed cols(filtering is done in metricHandler method)\n        var newAggColDef = _this.addMDPlanColumnHandler();\n\n        headers = _this.metricHandler(newAggColDef, selOptions, 'overall');\n        weekToBinHeader = _this.metricHandler(weekToBinColDef(_this.handleInputChange), selOptions, 'value');\n        binToWeekHeader = _this.metricHandler(binToWeekColDef(_this.handleInputChange), selOptions, 'value');\n\n        _this.setState({\n          aggColDef: headers,\n          weekToBinColDef: weekToBinHeader,\n          binToWeekColDef: binToWeekHeader,\n          selectedItems: selOptions\n        });\n      }\n    };\n\n    _this.handleInputChange = function (value, markdown_id, bin, week) {\n      var _this$state = _this.state,\n          aggTableData = _this$state.aggTableData,\n          planDetails = _this$state.planDetails; //_.cloneDeep(this.state.aggTableData);\n      //if state is not cloned this will update the state without rendering the component\n\n      _.map(Object.keys(aggTableData), function (level) {\n        var index = _.findIndex(aggTableData[level], {\n          markdown_id: markdown_id\n        });\n\n        var plan = aggTableData[level][index];\n\n        if (level === 'week_to_bin_agg_data') {\n          for (var i = 0; i < plan.week_level_data.length; i++) {\n            var item = plan.week_level_data[i];\n\n            if (item.week === week) {\n              for (var j = 0; j < item.bin_level_data.length; j++) {\n                var itm = item.bin_level_data[j];\n\n                if (itm.bin_num === bin) {\n                  itm.offer_value = value;\n                  return;\n                }\n              }\n            }\n          }\n        } else if (level === 'bin_to_week_agg_data') {\n          for (var _i = 0; _i < plan.bin_level_data.length; _i++) {\n            var _item = plan.bin_level_data[_i];\n            var stopLoop = false;\n\n            if (_item.bin === bin) {\n              for (var _j = 0; _j < _item.week_level_data.length; _j++) {\n                var _itm = _item.week_level_data[_j];\n\n                if (_itm.week_num === week) {\n                  _itm.offer_value = value;\n                  return;\n                }\n              }\n            }\n          }\n        }\n      }); //update cadence data for respective plan\n\n\n      var cadenceData = planDetails[markdown_id].cadenceData;\n      if (_.isEmpty(cadenceData) || _.isEmpty(cadenceData[0])) return; //edge case\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = Object.values(cadenceData)[0][Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var item = _step.value;\n\n          if (item.bins == bin) {\n            item[\"W\".concat(week)] = value;\n            return;\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    };\n\n    _this.isSwitchedPaln = function (val) {\n      if (val && !_.isEmpty(_this.state.reqObj) && _.isEmpty(_this.props.detailedSummary)) _this.props.getSummaryDetails(_this.state.reqObj);\n\n      var newAggColDef = _this.addMDPlanColumnHandler();\n\n      _this.setState({\n        switchedPlans: val,\n        columns: _.filter(detailedColDef, function (item) {\n          return !item.hideColumn;\n        }),\n        aggColDef: _.filter(newAggColDef, function (item) {\n          return !item.hideColumn;\n        }),\n        weekToBinColDef: _.filter(weekToBinColDef(_this.handleInputChange), function (item) {\n          return !item.hideColumn;\n        }),\n        binToWeekColDef: _.filter(binToWeekColDef(_this.handleInputChange), function (item) {\n          return !item.hideColumn;\n        }),\n        selectedItems: [{\n          label: 'Margin %',\n          value: 'margin_perc',\n          overall: 'overall_margin_perc',\n          detailed: 'week_level_margin_perc'\n        }],\n        expandedRowDetails: []\n      });\n    };\n\n    _this.onFilter = function (_ref) {\n      var filters = _ref.filters;\n      var payload = {\n        filters: {\n          hierarchy1: ['Footwear'],\n          hierarchy2: ['MNS'],\n          hierarchy3: ['Run/Train'],\n          hierarchy4: ['HERITAGE RUNNING'],\n          season: [],\n          clearance: [],\n          matrix: [],\n          exclusion_list: [],\n          style_color: [],\n          country: ['US'],\n          store_cluster: [],\n          store: [],\n          channel: ['Outlet'],\n          retail_flag: [1]\n        },\n        startDate: '2021-01-04',\n        endDate: '2021-02-21',\n        week: [1, 2, 3, 4, 5, 6, 7],\n        page_num: 1,\n        page_count: 5 // filters: {\n        //   hierarchy1: filters.hierarchy1,\n        //   hierarchy2: filters.hierarchy2,\n        //   hierarchy3: filters.hierarchy3,\n        //   hierarchy4: filters.hierarchy4,\n        //   hierarchy5: filters.hierarchy5,\n        //   season: this.props.selectedSeason,\n        //   clearance: this.props.selectedClearance,\n        //   matrix: this.props.selectedMatrix,\n        //   exclusion_list: this.props.selectedExclusionList,\n        //   style_color: this.props.selectedStyleColor,\n        //   country: this.props.selectedCountry,\n        //   store_cluster: this.props.selectedStoreCluster,\n        //   store: this.props.selectedStore,\n        //   channel: this.props.selectedChannel,\n        //   customStyleGroup: this.props.selectedCustomStyleGroup,\n        //   customStoreGroup: this.props.selectedCustomStoreGroup,\n        // },\n        // startDate: moment(this.props.startDate).format('YYYY-MM-DD'),\n        // endDate: moment(this.props.endDate).format('YYYY-MM-DD'),\n        // week: this.props.weeks,\n        // page_num: 1,\n        // page_count: 5,\n\n      };\n      if (_this.props.selectedChannel[0] === 'Web') payload.filters['ecom_flag'] = [1];\n      if (_this.props.selectedChannel[0] === 'Outlet') payload.filters['retail_flag'] = [1];\n\n      _this.getSummary(payload);\n\n      _this.props.getKPIdata(payload).then(function (res) {\n        if (res) _this.setState({\n          showKPIS: true,\n          KPILoader: false\n        });else _this.setState({\n          KPILoader: false\n        });\n      });\n\n      _this.setState({\n        reqObj: payload,\n        pageNum: 2,\n        expandedRowDetails: [],\n        KPILoader: true,\n        tableLoader: true,\n        switchedPlans: false\n      });\n    };\n\n    _this.roundOffNumber = function (val, key) {\n      if (!val && val !== 0 || val === 'NA') return val === 'NA' ? val : '-';\n\n      if (key === 'revenue' || key === 'margin' || key === 'cogs' || key === 'avg_retail') {\n        return toDollar({\n          value: val\n        });\n      }\n\n      if (key === 'margin_rate' || key === 'md_perc' || key === 'sell_through') {\n        return toPercentageMultipliedByHundred({\n          value: val\n        });\n      }\n\n      if (key === 'sales' || key === 'inv_oh' || key === 'wos') {\n        return toUnit({\n          value: val\n        });\n      }\n\n      return val;\n    };\n\n    _this.onScenarioSelection = function (rowData) {\n      var selectedRows = _this.state.selectedRows;\n\n      var foundEle = _.find(selectedRows, {\n        markdown_id: rowData.original.markdown_id\n      });\n\n      if (foundEle) {\n        _.remove(selectedRows, function (item) {\n          return item.markdown_id === rowData.original.markdown_id;\n        });\n      } else {\n        selectedRows.push(rowData.original);\n      }\n\n      _this.setState({\n        selectedRows: selectedRows\n      });\n\n      console.log(_this.state.selectedRows, 'rowwwww');\n    };\n\n    _this.addMDPlanColumnHandler = function () {\n      var newAggColDef = _.cloneDeep(aggColDef);\n\n      newAggColDef.splice(0, 0, {\n        id: 'selection',\n        groupByBoundary: true,\n        Header: 'Actions',\n        // fixed: 'left',\n        Cell: function Cell(props) {\n          var row = props.row,\n              rows = props.rows;\n\n          var mdPlan = row.original.markdown_id,\n              mainGrp = _.find(rows, {\n            isSelected: true,\n            original: {\n              markdown_id: mdPlan\n            }\n          }),\n              checkboxDisabled = mainGrp && !row.isSelected ? true : false;\n\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 379\n            },\n            __self: this\n          }, React.createElement(IndeterminateCheckbox, Object.assign({\n            row: row.id,\n            onClick: function onClick() {\n              _this.onScenarioSelection(row);\n            },\n            disabled: checkboxDisabled\n          }, row.getToggleRowSelectedProps(), {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 380\n            },\n            __self: this\n          })));\n        }\n      });\n      newAggColDef.splice(1, 0, {\n        Header: 'MD Plan',\n        accessor: 'md_plan',\n        cellClassName: 'summary_md_plan',\n        Cell: function Cell(_ref2) {\n          var row = _ref2.row;\n          var dateCheck = moment().isBefore(row.original.end_date); //show edit btn only when current date is before plan end date, i.e.,for ongoing and future plans\n          //add isSameOrBefore to show edit btn when current date and end date are same, i.e., plan ends today\n\n          return React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 400\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 401\n            },\n            __self: this\n          }, row.original.md_plan ? row.original.md_plan : null), React.createElement(\"div\", {\n            className: \"mt-1 mb-2\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 402\n            },\n            __self: this\n          }, row.original.md_plan && dateCheck ? React.createElement(\"button\", {\n            className: \"btn btn-secondary\",\n            onClick:\n            /*#__PURE__*/\n            _asyncToGenerator(\n            /*#__PURE__*/\n            _regeneratorRuntime.mark(function _callee() {\n              return _regeneratorRuntime.wrap(function _callee$(_context) {\n                while (1) {\n                  switch (_context.prev = _context.next) {\n                    case 0:\n                      _context.next = 2;\n                      return _this.props.setRetainFilters(true);\n\n                    case 2:\n                      _this.props.updateSidebar('/vis/Markdown/create-markdown');\n\n                      _this.props.history.push({\n                        pathname: \"/vis/Markdown/create-markdown\",\n                        state: {\n                          isEdit: true,\n                          planId: row.original.markdown_id\n                        }\n                      }); // this.setState({ showEditModal: true, selectedPlanDetails: row.original });\n\n\n                    case 4:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }\n              }, _callee);\n            })),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 404\n            },\n            __self: this\n          }, React.createElement(\"span\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 415\n            },\n            __self: this\n          }, React.createElement(\"i\", {\n            className: \"fa fa-pencil color-blue\",\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 416\n            },\n            __self: this\n          }, \"Edit\"))) : ''));\n        },\n        align: 'center',\n        downloadValue: 'plan'\n      });\n      return newAggColDef;\n    };\n\n    _this.getSummary =\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(payload) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return _this.props.getSummaryAggregated(payload).then(function (resp) {\n                  var newAggColDef = _this.addMDPlanColumnHandler();\n\n                  var planDetails = {};\n\n                  _.map(_toConsumableArray(resp.markdown_details), function (plan) {\n                    planDetails[plan.promo_code] = {\n                      cadenceData: plan.request_obj.cadenceData\n                    };\n                  });\n\n                  _this.setState({\n                    columns: _.filter(detailedColDef, function (item) {\n                      return !item.hideColumn;\n                    }),\n                    aggColDef: _.filter(newAggColDef, function (item) {\n                      return !item.hideColumn;\n                    }),\n                    weekToBinColDef: _.filter(weekToBinColDef(_this.handleInputChange), function (item) {\n                      return !item.hideColumn;\n                    }),\n                    binToWeekColDef: _.filter(binToWeekColDef(_this.handleInputChange), function (item) {\n                      return !item.hideColumn;\n                    }),\n                    tableLoader: false,\n                    aggTableData: {\n                      bin_to_week_agg_data: resp && resp.bin_to_week_agg_data,\n                      week_to_bin_agg_data: resp && resp.week_to_bin_agg_data\n                    },\n                    planDetails: planDetails\n                  });\n                });\n\n              case 2:\n                return _context2.abrupt(\"return\", true);\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n\n    _this.renderRowSubComponent = function (_ref5) {\n      var row = _ref5.row;\n      var expandedRowDetails = _this.state.expandedRowDetails; //contains all the expanded rows details\n\n      var foundLevel = _.filter(expandedRowDetails, {\n        //check if this row is expanded\n        markdown_id: row.original.markdown_id\n      });\n\n      var data = [];\n      if (!foundLevel[0]) return; //if not expanded then return\n\n      if (foundLevel[0] && foundLevel[0].level === 'week_to_bin') {\n        //if row is expanded on week_to_bin level, directly take the data from row\n        var newData = _.cloneDeep(row.original.week_level_data);\n\n        if (!newData) return;\n\n        _.map(newData, function (item) {\n          item.subRows = item.bin_level_data; //changing bin_level_data key into subRows, to acquire Expandable feature from reatc-table\n\n          item.markdown_id = row.original.markdown_id;\n          delete item.bin_level_data;\n          return item;\n        });\n\n        data = newData;\n      }\n\n      if (foundLevel[0] && foundLevel[0].level === 'bin_to_week') {\n        //if row is expanded on bin_to_week level, then find row data using markdown_id from the reducer aggregatedSummary\n        var _newData = _.find(_this.state.aggTableData.bin_to_week_agg_data, {\n          markdown_id: row.original.markdown_id\n        });\n\n        if (!_newData) return;\n        _newData = _.cloneDeep(_newData);\n\n        _.map(_newData.bin_level_data, function (item) {\n          item.subRows = item.week_level_data; //changing name to subRows to get Expandable feature from react-table\n\n          item.start_date = _newData.start_date;\n          item.end_date = _newData.end_date;\n          item.markdown_id = row.original.markdown_id;\n          delete item.week_level_data;\n        });\n\n        data = _newData.bin_level_data;\n      }\n\n      var columns = foundLevel[0] && foundLevel[0].level === 'week_to_bin' && row.original.week_level_data ? _this.state.weekToBinColDef : foundLevel[0] && foundLevel[0].level === 'bin_to_week' ? _this.state.binToWeekColDef : []; //selecting colfdef according to the level user has choosen\n\n      return React.createElement(\"div\", {\n        className: \"child-table\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 506\n        },\n        __self: this\n      }, React.createElement(DataTable, {\n        columns: columns,\n        data: data,\n        isHeaderHidden: true,\n        isChildComp: true //true for only subComponents, added to make some styling changes\n        ,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 507\n        },\n        __self: this\n      }));\n    };\n\n    _this.expandedRowDetailsHandler = function (row, level) {\n      //called whenever user clicks on a \">\" icon in the cell\n      //this is to track expanded row details, and on which level its expanded(week to bin/bin to week)\n      var expandedRowDetails = _this.state.expandedRowDetails;\n\n      if (_.find(expandedRowDetails, {\n        markdown_id: row.markdown_id\n      })) {\n        _.remove(expandedRowDetails, {\n          markdown_id: row.markdown_id\n        });\n      } else {\n        expandedRowDetails.push({\n          markdown_id: row.markdown_id,\n          level: level\n        });\n      }\n\n      _this.setState({\n        expandedRowDetails: expandedRowDetails\n      });\n    };\n\n    _this.nextPageHandler =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3() {\n      var payload;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              payload = _.cloneDeep(_this.state.reqObj);\n              payload.page_num = _this.state.pageNum;\n\n              _this.setState({\n                pageNum: _this.state.pageNum + 1\n              });\n\n              _context3.next = 5;\n              return _this.getSummary(payload);\n\n            case 5:\n              return _context3.abrupt(\"return\", true);\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    _this.onSaveAndResimulate = function () {\n      var markdown_idList = _this.state.selectedRows.map(function (item) {\n        return item.markdown_id;\n      });\n\n      var reqObj = [];\n\n      _.map(markdown_idList, function (item) {\n        var details = _.find(_this.props.markdownDetails, {\n          promo_code: item\n        });\n\n        reqObj.push({\n          cadenceData: _this.state.planDetails[item].cadenceData,\n          promo_code: details.promo_code\n        });\n      }); // this.props.sendResimulateAndSave({reqObj}).then((resp) => {\n      // if (resp.success)\n      //   this.getSummary(this.state.reqObj)\n      // })\n\n\n      console.log({\n        reqObj: reqObj\n      }, 'payload');\n    };\n\n    _this.onCopyRefreshed = function () {\n      var weekToBin = _this.state.weekToBinColDef.map(function (a) {\n        return a.Header;\n      });\n\n      var binToWeek = _this.state.binToWeekColDef;\n\n      var markdown_id = _this.state.selectedRows.map(function (data, i) {\n        return data.markdown_id;\n      });\n\n      console.log(markdown_id, 'markdown_id', weekToBin, 'weekToBin', binToWeek);\n    };\n\n    return _this;\n  }\n\n  _createClass(Summary, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.props.onResetSummaryTable();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      console.log(this.props.markdownDetails, 'markdownDetails');\n      var imageArray = [card1Image, card2Image, card3Image, card4Image, card1Image, card2Image, card3Image, card4Image, card1Image, card2Image];\n      var cardStyle = ['card-border1', 'card-border2', 'card-border3', 'card-border4', 'card-border1', 'card-border2', 'card-border3', 'card-border4', 'card-border1', 'card-border2'];\n      return React.createElement(LoadingOverlay, {\n        loader: this.props.getOverlayLoaderState || this.state.KPILoader || this.state.tableLoader,\n        spinner: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 591\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"createMd pl-2 pr-2 summary-comp\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 594\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"card CalendarMain promoCalendarDiv1 mt-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 595\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 596\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        className: \"font-size-14  pad-10 markdown-heading\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 597\n        },\n        __self: this\n      }, \"MarkSmart /\", React.createElement(\"span\", {\n        className: \"font-bold color-blue\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 598\n        },\n        __self: this\n      }, \"Summary\"))), React.createElement(\"hr\", {\n        className: \"mb-2\",\n        style: {\n          marginTop: '-4px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 601\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"filterCol mb-4\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 607\n        },\n        __self: this\n      }, React.createElement(Filters, {\n        storeClusterDisable: true,\n        onReset: function onReset(e) {\n          _this2.setState({\n            textStr: 'Please select filters to show Markdown plans',\n            showKPIS: false\n          });\n\n          _this2.props.onResetSummaryTable();\n        },\n        hierarchy: this.state.filters,\n        onFilter: this.onFilter,\n        dateRange: true,\n        filtersOptions: [{\n          type: 'country',\n          isMandatory: true,\n          isMultiple: false\n        }, {\n          type: 'channel',\n          isMandatory: true,\n          isMultiple: false\n        }, {\n          type: 'storeCluster',\n          isMandatory: false,\n          isMultiple: true\n        }, {\n          type: 'customStoreGroup',\n          isMandatory: false,\n          isMultiple: true\n        }, {\n          type: 'store',\n          isMandatory: false,\n          isMultiple: true\n        }, {\n          type: 'hierarchy1',\n          isMandatory: true,\n          isMultiple: false,\n          isHierarchy: true\n        }, {\n          type: 'hierarchy2',\n          isMandatory: true,\n          isMultiple: false,\n          isHierarchy: true\n        }, {\n          type: 'hierarchy3',\n          isMandatory: true,\n          isMultiple: false,\n          isHierarchy: true\n        }, {\n          type: 'hierarchy4',\n          isMandatory: true,\n          isMultiple: false,\n          isHierarchy: true\n        }, {\n          type: 'hierarchy5',\n          isMandatory: true,\n          isMultiple: false,\n          isHierarchy: true\n        }, {\n          type: 'season',\n          isMandatory: false,\n          isMultiple: true\n        }, {\n          type: 'matrix',\n          isMandatory: false,\n          isMultiple: true\n        }, {\n          type: 'exclusionList',\n          isMandatory: false,\n          isMultiple: true\n        }, {\n          type: 'clearance',\n          isMandatory: false,\n          isMultiple: true\n        }, {\n          type: 'customStyleGroup',\n          isMandatory: false,\n          isMultiple: true\n        }, {\n          type: 'styleColor',\n          isMandatory: false,\n          isMultiple: true\n        }],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 608\n        },\n        __self: this\n      }))), this.props.summaryKPIData && this.state.showKPIS ? // <div className=\"cardContainerstyle\" style={{ marginTop: '10px' }}>\n      React.createElement(\"div\", {\n        className: \"cardContainerstyle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 690\n        },\n        __self: this\n      }, this.props.summaryKPIData && this.props.summaryKPIData.columnMapping && Array.isArray(Object.keys(this.props.summaryKPIData.columnMapping)) && Object.keys(this.props.summaryKPIData.columnMapping).map(function (key, index) {\n        return (// <div className=\"col-md-3 col-sm-3 col-xs-6 p-2\">\n          React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 696\n            },\n            __self: this\n          }, React.createElement(CardComponent, {\n            cardImage: imageArray[index] //item.type && item.type.charAt(0).toUpperCase() + item.type.slice(1);\n            //cardText={key && key.charAt(0).toUpperCase() + key.slice(1)}\n            ,\n            cardText: _this2.props.summaryKPIData.columnMapping && _this2.props.summaryKPIData.columnMapping[key] && _this2.props.summaryKPIData.columnMapping[key].charAt(0) + _this2.props.summaryKPIData.columnMapping[key].slice(1).toLowerCase(),\n            cardValue: _this2.props.summaryKPIData.KPIS.lw && _this2.roundOffNumber(_this2.props.summaryKPIData.KPIS.lw[key], key),\n            cardValueSecond: _this2.props.summaryKPIData.KPIS.tw && _this2.roundOffNumber(_this2.props.summaryKPIData.KPIS.tw[key], key),\n            cardValueThird: _this2.props.summaryKPIData.KPIS.total && _this2.roundOffNumber(_this2.props.summaryKPIData.KPIS.total[key], key),\n            cardWeekText: _this2.state.cardWeekText,\n            cardMonthText: _this2.state.cardMonthText,\n            cardTotalText: _this2.state.cardTotalText,\n            cardStyles: {\n              cardClass: cardStyle[index] //cardValue: 'card1-value',\n              //cardImg: summaryKPIData.cardStyleImg,\n              //cardValueSecond: 'card-value-second',\n              //cardSubHeading: 'card-subHeading',\n\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 697\n            },\n            __self: this\n          }))\n        );\n      })) : null, !_.isEmpty(this.props.detailedSummary) || !_.isEmpty(this.state.aggTableData) ? React.createElement(\"div\", {\n        className: \"card pt-3 px-3 mt-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 735\n        },\n        __self: this\n      }, React.createElement(ColSelBtn, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 736\n        },\n        __self: this\n      }, (this.state.switchedPlans && !_.isEmpty(this.state.columns) || !this.state.switchedPlans && !_.isEmpty(this.state.aggColDef)) && React.createElement(ColumnSelection, {\n        onHandleSelect: this.onHandleSelect,\n        columnOptions: this.state.columnOptions,\n        selectedItems: this.state.selectedItems,\n        selLabels: this.state.selLabels,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 739\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"switchCss\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 746\n        },\n        __self: this\n      }, React.createElement(Switch, {\n        checked: this.state.switchedPlans,\n        onSwitchHandler: this.isSwitchedPaln,\n        leftLabel: \"Aggregated\",\n        rightLabel: \"Detailed\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 747\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        style: {\n          padding: '1rem'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 754\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"btn btn-primary\" // disabled={true}\n        ,\n        onClick: this.onCopyRefreshed,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 755\n        },\n        __self: this\n      }, \"Copy Refreshed\"), \"\\xA0\", React.createElement(\"button\", {\n        // disabled={true}\n        className: \"btn btn-primary\",\n        onClick: this.onSaveAndResimulate,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 762\n        },\n        __self: this\n      }, \"Save\"))), this.state.switchedPlans ? React.createElement(DataTable, {\n        columns: this.state.columns,\n        isSort: true,\n        data: this.props.detailedSummary,\n        updateMyData: this.updateMyData,\n        isPagination: true,\n        rowsPerPage: 5,\n        getCellProps: function getCellProps(cellInfo) {\n          return {\n            style: {\n              backgroundColor: _this2.bgmCol(cellInfo),\n              color: _this2.txtCol(cellInfo),\n              margin: '4px 4px',\n              borderRadius: '2px'\n            }\n          };\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 771\n        },\n        __self: this\n      }) : React.createElement(DataTable, {\n        columns: this.state.aggColDef,\n        isSort: true,\n        data: this.state.aggTableData.week_to_bin_agg_data,\n        updateMyData: this.updateMyData,\n        isPagination: true,\n        rowsPerPage: 5,\n        renderRowSubComponent: this.renderRowSubComponent,\n        nextPageHandler: this.nextPageHandler,\n        getCellProps: function getCellProps(cellInfo) {\n          return {\n            style: {\n              backgroundColor: _this2.bgmCol(cellInfo),\n              color: _this2.txtCol(cellInfo),\n              margin: '4px 4px',\n              borderRadius: '2px'\n            },\n            onClick: function onClick(e) {\n              //added to track on which cell user has clicked\n              var classList = e.target.classList;\n              if (classList && !(classList.contains('expanded-icon-size') || classList.contains('summary-table-icon'))) //user clicks on div(i.e, row is not expanded)  then return\n                return;\n              if (cellInfo.column.id === 'expander') //expander is Date Range cell\n                _this2.expandedRowDetailsHandler(cellInfo.row.original, 'week_to_bin');else if (cellInfo.column.id === 'expander1') //expander1 is Bins cell\n                _this2.expandedRowDetailsHandler(cellInfo.row.original, 'bin_to_week');\n            }\n          };\n        },\n        RowCheck: function RowCheck(_ref7) {\n          var row = _ref7.row,\n              column = _ref7.column;\n          if (!(column.id === 'expander' || column.id === 'expander1')) return; //disables sibling cell within a row, when a particular row is expanded\n\n          var foundLevel = _.filter(_this2.state.expandedRowDetails, {\n            markdown_id: row.original.markdown_id\n          });\n\n          if (!foundLevel[0]) return;\n          return foundLevel[0].level === 'week_to_bin' && column.id === 'expander1' || foundLevel[0].level === 'bin_to_week' && column.id === 'expander' ? 'tdtd disable-summary-cell' : null;\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 788\n        },\n        __self: this\n      })) : React.createElement(NoData, {\n        description: this.state.textStr,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 842\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Summary;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    finalizeMarkdownData: store.draftStatusReducer.markdowns,\n    getOverlayLoaderState: store.loaderReducer.overlayLoaderState,\n    getOverlayLoaderText: store.loaderReducer.loaderText,\n    getColumnHeaders: store.draftStatusReducer.columnHeaders,\n    getMetricOptions: store.finalizeReducer.metricOptions,\n    selectedHierarchy1: store.filtersReducer.selectedHierarchy1,\n    selectedHierarchy2: store.filtersReducer.selectedHierarchy2,\n    selectedHierarchy3: store.filtersReducer.selectedHierarchy3,\n    selectedHierarchy4: store.filtersReducer.selectedHierarchy4,\n    selectedHierarchy5: store.filtersReducer.selectedHierarchy5,\n    startDate: store.filtersReducer.startDate,\n    endDate: store.filtersReducer.endDate,\n    weeks: store.filtersReducer.weeks,\n    selectedSeason: store.filtersReducer.selectedSeason,\n    selectedClearance: store.filtersReducer.selectedClearance,\n    selectedMatrix: store.filtersReducer.selectedMatrix,\n    selectedExclusionList: store.filtersReducer.selectedExclusionList,\n    selectedStyleColor: store.filtersReducer.selectedStyleColor,\n    selectedCountry: store.filtersReducer.selectedCountry,\n    selectedStoreCluster: store.filtersReducer.selectedStoreCluster,\n    selectedStore: store.filtersReducer.selectedStore,\n    selectedChannel: store.filtersReducer.selectedChannel,\n    markdownDetails: store.summaryMDReducer.markdownDetails,\n    summaryKPIData: store.summaryMDReducer.summaryKPIData,\n    detailedSummary: store.summaryMDReducer.detailedSummary,\n    aggregatedSummary: store.summaryMDReducer.aggregatedSummary\n  };\n};\n\nvar mapActionToProps = {\n  getSummaryDetails: SummaryAction.getSummaryDetails,\n  getSummaryAggregated: SummaryAction.getSummaryAggregated,\n  onResetSummaryTable: SummaryAction.onResetSummaryTable,\n  getKPIdata: SummaryAction.getKPIdata,\n  updateSidebar: plannedReportsAction.updateSidebar,\n  setRetainFilters: filterActions.setRetainFilters,\n  sendResimulateAndSave: SummaryAction.sendResimulateAndSave\n};\nexport default connect(mapStateToProps, mapActionToProps)(withRouter(Summary));\nvar ColSelBtn = styled.div(_templateObject());","map":{"version":3,"sources":["/home/user/generic-markdown-frontend/src/components/Summary/Summary.js"],"names":["React","Component","connect","withRouter","Filters","styled","LoadingOverlay","NoData","SummaryAction","plannedReportsAction","manuallyCreateMdActions","aggColDef","binToWeekColDef","weekToBinColDef","detailedColDef","_","DataTable","ColumnSelection","moment","card1Image","card2Image","card3Image","card4Image","Switch","CardComponent","filterActions","IndeterminateCheckbox","toPercentageMultipliedByHundred","toUnit","toDollar","Summary","state","switchedPlans","textStr","firstCardFirstValue","firstCardSecondValue","secondCardFirstValue","secondCardSecondValue","thirdCardFirstValue","thirdCardSecondValue","fourthCardFirstValue","fourthCardSecondValue","cardWeekText","cardMonthText","cardTotalText","selectedRows","selectedItems","label","value","overall","detailed","columnOptions","selLabels","columns","tableData","showKPIS","expandedRowDetails","pageNum","KPILoader","tableLoader","planDetails","findStatusColor","status","color","high","medium","low","bgmCol","cellInfo","column","id","row","original","md_status","bgCol","txtCol","metricHandler","selOptions","val","headers","cloneDeep","remove","item","metric","hideColumn","forEach","newTableCols","filter","a","accessor","found","find","length","spliceAt","splice","onHandleSelect","weekToBinHeader","binToWeekHeader","setState","newAggColDef","addMDPlanColumnHandler","handleInputChange","markdown_id","bin","week","aggTableData","map","Object","keys","level","index","findIndex","plan","i","week_level_data","j","bin_level_data","itm","bin_num","offer_value","stopLoop","week_num","cadenceData","isEmpty","values","bins","isSwitchedPaln","reqObj","props","detailedSummary","getSummaryDetails","onFilter","filters","payload","hierarchy1","hierarchy2","hierarchy3","hierarchy4","season","clearance","matrix","exclusion_list","style_color","country","store_cluster","store","channel","retail_flag","startDate","endDate","page_num","page_count","selectedChannel","getSummary","getKPIdata","then","res","roundOffNumber","key","onScenarioSelection","rowData","foundEle","push","console","log","groupByBoundary","Header","Cell","rows","mdPlan","mainGrp","isSelected","checkboxDisabled","getToggleRowSelectedProps","cellClassName","dateCheck","isBefore","end_date","md_plan","setRetainFilters","updateSidebar","history","pathname","isEdit","planId","align","downloadValue","getSummaryAggregated","resp","markdown_details","promo_code","request_obj","bin_to_week_agg_data","week_to_bin_agg_data","renderRowSubComponent","foundLevel","data","newData","subRows","start_date","expandedRowDetailsHandler","nextPageHandler","onSaveAndResimulate","markdown_idList","details","markdownDetails","onCopyRefreshed","weekToBin","binToWeek","onResetSummaryTable","imageArray","cardStyle","getOverlayLoaderState","marginTop","e","type","isMandatory","isMultiple","isHierarchy","summaryKPIData","columnMapping","Array","isArray","charAt","slice","toLowerCase","KPIS","lw","tw","total","cardClass","padding","updateMyData","style","backgroundColor","margin","borderRadius","onClick","classList","target","contains","mapStateToProps","finalizeMarkdownData","draftStatusReducer","markdowns","loaderReducer","overlayLoaderState","getOverlayLoaderText","loaderText","getColumnHeaders","columnHeaders","getMetricOptions","finalizeReducer","metricOptions","selectedHierarchy1","filtersReducer","selectedHierarchy2","selectedHierarchy3","selectedHierarchy4","selectedHierarchy5","weeks","selectedSeason","selectedClearance","selectedMatrix","selectedExclusionList","selectedStyleColor","selectedCountry","selectedStoreCluster","selectedStore","summaryMDReducer","aggregatedSummary","mapActionToProps","sendResimulateAndSave","ColSelBtn","div"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\nimport Filters from '../../services/filters';\nimport './summaryStyle.css';\nimport styled from 'styled-components';\nimport LoadingOverlay from '../../utils/Loader';\nimport NoData from '../noTableData';\nimport SummaryAction from '../../actions/summaryAction';\nimport plannedReportsAction from '../../actions/plannedReportsAction';\nimport manuallyCreateMdActions from '../../actions/manuallyCreateMdActions.js';\nimport { aggColDef, binToWeekColDef, weekToBinColDef, detailedColDef } from './aggColdef';\nimport _ from 'lodash';\nimport DataTable from '../../services/reactTable';\nimport ColumnSelection from '../columnSelection';\nimport moment from 'moment';\nimport card1Image from '../../images/card1Image.png';\nimport card2Image from '../../images/card2Image.png';\nimport card3Image from '../../images/card3Image.png';\nimport card4Image from '../../images/card4Image.png';\nimport Switch from '../../services/toggleSwitch';\nimport CardComponent from '../../services/cardComponent/cardComponent';\nimport filterActions from '../../actions/filtersAction';\nimport IndeterminateCheckbox from '../../components/cellRenders/inderterminateCheckbox';\nimport { toPercentageMultipliedByHundred, toUnit, toDollar } from '../../helper/formatter';\n\nclass Summary extends Component {\n  state = {\n    switchedPlans: false, //default aggregated view\n    textStr: 'Please select filters to show Markdown plans',\n    // firstCardText: 'KPIs to be decided',\n    firstCardFirstValue: '12%',\n    firstCardSecondValue: '24%',\n    secondCardFirstValue: '16%',\n    secondCardSecondValue: '20%',\n    thirdCardFirstValue: '6%',\n    thirdCardSecondValue: '10%',\n    fourthCardFirstValue: '345',\n    fourthCardSecondValue: '3,457',\n    cardWeekText: 'LW',\n    cardMonthText: 'TW',\n    cardTotalText: 'Total',\n    selectedRows: [],\n    selectedItems: [\n      {\n        label: 'Margin %',\n        value: 'margin_perc', //for subcomponents\n        overall: 'overall_margin_perc', //for main table(agg-parent)\n        detailed: 'week_level_margin_perc', //for detailed table\n      },\n    ],\n    columnOptions: [\n      {\n        label: 'Margin %',\n        value: 'margin_perc',\n        overall: 'overall_margin_perc',\n        detailed: 'week_level_margin_perc',\n      },\n      {\n        label: 'Margin $',\n        value: 'margin$',\n        overall: 'overall_margin$',\n        detailed: 'week_level_margin$',\n      },\n      {\n        label: 'AUM $',\n        value: 'aum',\n        overall: 'overall_aum',\n        detailed: 'week_level_aum',\n      },\n      {\n        label: 'Revenue $',\n        value: 'revenue$',\n        overall: 'overall_revenue$',\n        detailed: 'week_level_revenue$',\n      },\n      // {\n      //   label: 'Planned units',\n      //   value: 'planned_units',\n      //   overall: 'overall_planned_units',\n      //   detailed: 'week_level_planned_units',\n      // },\n      {\n        label: 'Markdown units',\n        value: 'markdown_units',\n        overall: 'overall_markdown_units',\n        detailed: 'week_level_markdown_units',\n      },\n      {\n        label: 'AUR $',\n        value: 'aur',\n        overall: 'overall_aur',\n        detailed: 'week_level_aur',\n      },\n    ],\n    selLabels: ['Margin', 'Sales'],\n    columns: [],\n    aggColDef: [],\n    weekToBinColDef: [],\n    binToWeekColDef: [],\n    tableData: [],\n    showKPIS: false,\n    expandedRowDetails: [],\n    pageNum: 1,\n    KPILoader: false,\n    tableLoader: false,\n    planDetails: {},\n  };\n\n  componentWillUnmount() {\n    this.props.onResetSummaryTable();\n  }\n  findStatusColor = (status, color) => {\n    switch (status) {\n      case 'high':\n        return color.high;\n      case 'medium':\n        return color.medium;\n      case 'low':\n        return color.low;\n      default:\n        break;\n    }\n  };\n\n  bgmCol = (cellInfo) => {\n    if (cellInfo.column.id === 'md_status') var status = cellInfo.row.original.md_status;\n    let bgCol = {\n      high: '#F8E8E8',\n      medium: '#FCF3D1',\n      low: '#E8F8F5',\n    };\n    return this.findStatusColor(status, bgCol);\n  };\n  txtCol = (cellInfo) => {\n    if (cellInfo.column.id === 'md_status') var status = cellInfo.row.original.md_status;\n    let txtCol = {\n      high: '#D38485',\n      medium: '#F0C53A',\n      low: '#66CFBA',\n    };\n    return this.findStatusColor(status, txtCol);\n  };\n  metricHandler = (columns, selOptions, val) => {\n    // val=detailed for detailed table, val=overall for agg-parent col and val=value for subcomponent cols\n    let headers = _.cloneDeep(columns);\n    _.remove(headers, (item) => item.metric || item.hideColumn); //removing metric:true and hideColumn: true cols\n    _.forEach(selOptions, (item) => {\n      let newTableCols = _.filter(headers, (a) => {\n        return a.accessor === item[val];\n      });\n      let found = _.find(columns, { accessor: item[val] });\n      if (newTableCols.length == 0) {\n        let spliceAt = headers.length - 0; //modify here if the new col needs to be added at a specific index\n        headers.splice(spliceAt, 0, found);\n      }\n    });\n\n    return headers;\n  };\n  onHandleSelect = (selOptions) => {\n    let headers, weekToBinHeader, binToWeekHeader;\n    if (this.state.switchedPlans) {\n      //detailed table case\n      headers = this.metricHandler(detailedColDef, selOptions, 'detailed');\n      this.setState({\n        columns: headers,\n        selectedItems: selOptions,\n      });\n    } else {\n      //agg-table case: needs to update 3 coldefs,\n      //imported coldefs already has all of the required columns,\n      //we are just filtering out needed cols(filtering is done in metricHandler method)\n      let newAggColDef = this.addMDPlanColumnHandler();\n      headers = this.metricHandler(newAggColDef, selOptions, 'overall');\n      weekToBinHeader = this.metricHandler(\n        weekToBinColDef(this.handleInputChange),\n        selOptions,\n        'value'\n      );\n      binToWeekHeader = this.metricHandler(\n        binToWeekColDef(this.handleInputChange),\n        selOptions,\n        'value'\n      );\n\n      this.setState({\n        aggColDef: headers,\n        weekToBinColDef: weekToBinHeader,\n        binToWeekColDef: binToWeekHeader,\n        selectedItems: selOptions,\n      });\n    }\n  };\n  handleInputChange = (value, markdown_id, bin, week) => {\n    let { aggTableData, planDetails } = this.state; //_.cloneDeep(this.state.aggTableData);\n    //if state is not cloned this will update the state without rendering the component\n\n    _.map(Object.keys(aggTableData), (level) => {\n      let index = _.findIndex(aggTableData[level], { markdown_id: markdown_id });\n      let plan = aggTableData[level][index];\n\n      if (level === 'week_to_bin_agg_data') {\n        for (let i = 0; i < plan.week_level_data.length; i++) {\n          let item = plan.week_level_data[i];\n          if (item.week === week) {\n            for (let j = 0; j < item.bin_level_data.length; j++) {\n              let itm = item.bin_level_data[j];\n              if (itm.bin_num === bin) {\n                itm.offer_value = value;\n                return;\n              }\n            }\n          }\n        }\n      } else if (level === 'bin_to_week_agg_data') {\n        for (let i = 0; i < plan.bin_level_data.length; i++) {\n          let item = plan.bin_level_data[i];\n          let stopLoop = false;\n          if (item.bin === bin) {\n            for (let j = 0; j < item.week_level_data.length; j++) {\n              let itm = item.week_level_data[j];\n              if (itm.week_num === week) {\n                itm.offer_value = value;\n                return;\n              }\n            }\n          }\n        }\n      }\n    });\n\n    //update cadence data for respective plan\n    let cadenceData = planDetails[markdown_id].cadenceData;\n    if (_.isEmpty(cadenceData) || _.isEmpty(cadenceData[0])) return; //edge case\n    for (let item of Object.values(cadenceData)[0]) {\n      if (item.bins == bin) {\n        item[`W${week}`] = value;\n        return;\n      }\n    }\n  };\n  isSwitchedPaln = (val) => {\n    if (val && !_.isEmpty(this.state.reqObj) && _.isEmpty(this.props.detailedSummary))\n      this.props.getSummaryDetails(this.state.reqObj);\n    let newAggColDef = this.addMDPlanColumnHandler();\n\n    this.setState({\n      switchedPlans: val,\n      columns: _.filter(detailedColDef, (item) => !item.hideColumn),\n      aggColDef: _.filter(newAggColDef, (item) => !item.hideColumn),\n      weekToBinColDef: _.filter(\n        weekToBinColDef(this.handleInputChange),\n        (item) => !item.hideColumn\n      ),\n      binToWeekColDef: _.filter(\n        binToWeekColDef(this.handleInputChange),\n        (item) => !item.hideColumn\n      ),\n      selectedItems: [\n        {\n          label: 'Margin %',\n          value: 'margin_perc',\n          overall: 'overall_margin_perc',\n          detailed: 'week_level_margin_perc',\n        },\n      ],\n      expandedRowDetails: [],\n    });\n  };\n  onFilter = ({ filters }) => {\n    let payload = {\n      filters: {\n        hierarchy1: ['Footwear'],\n        hierarchy2: ['MNS'],\n        hierarchy3: ['Run/Train'],\n        hierarchy4: ['HERITAGE RUNNING'],\n        season: [],\n        clearance: [],\n        matrix: [],\n        exclusion_list: [],\n        style_color: [],\n        country: ['US'],\n        store_cluster: [],\n        store: [],\n        channel: ['Outlet'],\n        retail_flag: [1],\n      },\n      startDate: '2021-01-04',\n      endDate: '2021-02-21',\n      week: [1, 2, 3, 4, 5, 6, 7],\n      page_num: 1,\n      page_count: 5,\n      // filters: {\n      //   hierarchy1: filters.hierarchy1,\n      //   hierarchy2: filters.hierarchy2,\n      //   hierarchy3: filters.hierarchy3,\n      //   hierarchy4: filters.hierarchy4,\n      //   hierarchy5: filters.hierarchy5,\n      //   season: this.props.selectedSeason,\n      //   clearance: this.props.selectedClearance,\n      //   matrix: this.props.selectedMatrix,\n      //   exclusion_list: this.props.selectedExclusionList,\n      //   style_color: this.props.selectedStyleColor,\n      //   country: this.props.selectedCountry,\n      //   store_cluster: this.props.selectedStoreCluster,\n      //   store: this.props.selectedStore,\n      //   channel: this.props.selectedChannel,\n      //   customStyleGroup: this.props.selectedCustomStyleGroup,\n      //   customStoreGroup: this.props.selectedCustomStoreGroup,\n      // },\n      // startDate: moment(this.props.startDate).format('YYYY-MM-DD'),\n      // endDate: moment(this.props.endDate).format('YYYY-MM-DD'),\n      // week: this.props.weeks,\n      // page_num: 1,\n      // page_count: 5,\n    };\n    if (this.props.selectedChannel[0] === 'Web') payload.filters['ecom_flag'] = [1];\n    if (this.props.selectedChannel[0] === 'Outlet') payload.filters['retail_flag'] = [1];\n\n    this.getSummary(payload);\n    this.props.getKPIdata(payload).then((res) => {\n      if (res) this.setState({ showKPIS: true, KPILoader: false });\n      else this.setState({ KPILoader: false });\n    });\n    this.setState({\n      reqObj: payload,\n      pageNum: 2,\n      expandedRowDetails: [],\n      KPILoader: true,\n      tableLoader: true,\n      switchedPlans: false,\n    });\n  };\n  roundOffNumber = (val, key) => {\n    if ((!val && val !== 0) || val === 'NA') return val === 'NA' ? val : '-';\n    if (key === 'revenue' || key === 'margin' || key === 'cogs' || key === 'avg_retail') {\n      return toDollar({ value: val });\n    }\n    if (key === 'margin_rate' || key === 'md_perc' || key === 'sell_through') {\n      return toPercentageMultipliedByHundred({ value: val });\n    }\n    if (key === 'sales' || key === 'inv_oh' || key === 'wos') {\n      return toUnit({ value: val });\n    }\n    return val;\n  };\n  onScenarioSelection = (rowData) => {\n    let { selectedRows } = this.state;\n    let foundEle = _.find(selectedRows, { markdown_id: rowData.original.markdown_id });\n    if (foundEle) {\n      _.remove(selectedRows, (item) => item.markdown_id === rowData.original.markdown_id);\n    } else {\n      selectedRows.push(rowData.original);\n    }\n    this.setState({\n      selectedRows,\n    });\n    console.log(this.state.selectedRows, 'rowwwww');\n  };\n\n  addMDPlanColumnHandler = () => {\n    let newAggColDef = _.cloneDeep(aggColDef);\n    newAggColDef.splice(0, 0, {\n      id: 'selection',\n      groupByBoundary: true,\n      Header: 'Actions',\n      // fixed: 'left',\n      Cell: (props) => {\n        let { row, rows } = props;\n        let mdPlan = row.original.markdown_id,\n          mainGrp = _.find(rows, {\n            isSelected: true,\n            original: { markdown_id: mdPlan },\n          }),\n          checkboxDisabled = mainGrp && !row.isSelected ? true : false;\n\n        return (\n          <div>\n            <IndeterminateCheckbox\n              row={row.id}\n              onClick={() => {\n                this.onScenarioSelection(row);\n              }}\n              disabled={checkboxDisabled}\n              {...row.getToggleRowSelectedProps()}\n            />\n          </div>\n        );\n      },\n    });\n    newAggColDef.splice(1, 0, {\n      Header: 'MD Plan',\n      accessor: 'md_plan',\n      cellClassName: 'summary_md_plan',\n      Cell: ({ row }) => {\n        let dateCheck = moment().isBefore(row.original.end_date); //show edit btn only when current date is before plan end date, i.e.,for ongoing and future plans\n        //add isSameOrBefore to show edit btn when current date and end date are same, i.e., plan ends today\n        return (\n          <div>\n            <span>{row.original.md_plan ? row.original.md_plan : null}</span>\n            <div className=\"mt-1 mb-2\">\n              {row.original.md_plan && dateCheck ? (\n                <button\n                  className=\"btn btn-secondary\"\n                  onClick={async () => {\n                    await this.props.setRetainFilters(true);\n                    this.props.updateSidebar('/vis/Markdown/create-markdown');\n                    this.props.history.push({\n                      pathname: `/vis/Markdown/create-markdown`,\n                      state: { isEdit: true, planId: row.original.markdown_id },\n                    });\n                    // this.setState({ showEditModal: true, selectedPlanDetails: row.original });\n                  }}>\n                  <span>\n                    <i className=\"fa fa-pencil color-blue\">Edit</i>\n                  </span>\n                </button>\n              ) : (\n                ''\n              )}\n            </div>\n          </div>\n        );\n      },\n      align: 'center',\n      downloadValue: 'plan',\n    });\n    return newAggColDef;\n  };\n  getSummary = async (payload) => {\n    await this.props.getSummaryAggregated(payload).then((resp) => {\n      let newAggColDef = this.addMDPlanColumnHandler();\n      let planDetails = {};\n      _.map([...resp.markdown_details], (plan) => {\n        planDetails[plan.promo_code] = {\n          cadenceData: plan.request_obj.cadenceData,\n        };\n      });\n      this.setState({\n        columns: _.filter(detailedColDef, (item) => !item.hideColumn),\n        aggColDef: _.filter(newAggColDef, (item) => !item.hideColumn),\n        weekToBinColDef: _.filter(\n          weekToBinColDef(this.handleInputChange),\n          (item) => !item.hideColumn\n        ),\n        binToWeekColDef: _.filter(\n          binToWeekColDef(this.handleInputChange),\n          (item) => !item.hideColumn\n        ),\n        tableLoader: false,\n        aggTableData: {\n          bin_to_week_agg_data: resp && resp.bin_to_week_agg_data,\n          week_to_bin_agg_data: resp && resp.week_to_bin_agg_data,\n        },\n        planDetails,\n      });\n    });\n    return true;\n  };\n  renderRowSubComponent = ({ row }) => {\n    let { expandedRowDetails } = this.state; //contains all the expanded rows details\n    let foundLevel = _.filter(expandedRowDetails, {\n      //check if this row is expanded\n      markdown_id: row.original.markdown_id,\n    });\n    let data = [];\n    if (!foundLevel[0]) return; //if not expanded then return\n\n    if (foundLevel[0] && foundLevel[0].level === 'week_to_bin') {\n      //if row is expanded on week_to_bin level, directly take the data from row\n      let newData = _.cloneDeep(row.original.week_level_data);\n      if (!newData) return;\n      _.map(newData, (item) => {\n        item.subRows = item.bin_level_data; //changing bin_level_data key into subRows, to acquire Expandable feature from reatc-table\n        item.markdown_id = row.original.markdown_id;\n        delete item.bin_level_data;\n        return item;\n      });\n      data = newData;\n    }\n    if (foundLevel[0] && foundLevel[0].level === 'bin_to_week') {\n      //if row is expanded on bin_to_week level, then find row data using markdown_id from the reducer aggregatedSummary\n      let newData = _.find(this.state.aggTableData.bin_to_week_agg_data, {\n        markdown_id: row.original.markdown_id,\n      });\n      if (!newData) return;\n      newData = _.cloneDeep(newData);\n      _.map(newData.bin_level_data, (item) => {\n        item.subRows = item.week_level_data; //changing name to subRows to get Expandable feature from react-table\n        item.start_date = newData.start_date;\n        item.end_date = newData.end_date;\n        item.markdown_id = row.original.markdown_id;\n        delete item.week_level_data;\n      });\n\n      data = newData.bin_level_data;\n    }\n    let columns =\n      foundLevel[0] && foundLevel[0].level === 'week_to_bin' && row.original.week_level_data\n        ? this.state.weekToBinColDef\n        : foundLevel[0] && foundLevel[0].level === 'bin_to_week'\n        ? this.state.binToWeekColDef\n        : []; //selecting colfdef according to the level user has choosen\n    return (\n      <div className=\"child-table\">\n        <DataTable\n          columns={columns}\n          data={data}\n          isHeaderHidden={true}\n          isChildComp={true} //true for only subComponents, added to make some styling changes\n        />\n      </div>\n    );\n  };\n  expandedRowDetailsHandler = (row, level) => {\n    //called whenever user clicks on a \">\" icon in the cell\n    //this is to track expanded row details, and on which level its expanded(week to bin/bin to week)\n    let { expandedRowDetails } = this.state;\n    if (_.find(expandedRowDetails, { markdown_id: row.markdown_id })) {\n      _.remove(expandedRowDetails, { markdown_id: row.markdown_id });\n    } else {\n      expandedRowDetails.push({\n        markdown_id: row.markdown_id,\n        level,\n      });\n    }\n    this.setState({ expandedRowDetails });\n  };\n  nextPageHandler = async () => {\n    let payload = _.cloneDeep(this.state.reqObj);\n    payload.page_num = this.state.pageNum;\n    this.setState({ pageNum: this.state.pageNum + 1 });\n    await this.getSummary(payload);\n    return true;\n  };\n  onSaveAndResimulate = () => {\n    let markdown_idList = this.state.selectedRows.map((item) => item.markdown_id);\n    let reqObj = [];\n    _.map(markdown_idList, (item) => {\n      let details = _.find(this.props.markdownDetails, {\n        promo_code: item,\n      });\n      reqObj.push({\n        cadenceData: this.state.planDetails[item].cadenceData,\n        promo_code: details.promo_code,\n      });\n    });\n    // this.props.sendResimulateAndSave({reqObj}).then((resp) => {\n    // if (resp.success)\n    //   this.getSummary(this.state.reqObj)\n    // })\n    console.log({ reqObj }, 'payload');\n  };\n  onCopyRefreshed = () => {\n    let weekToBin = this.state.weekToBinColDef.map((a) => a.Header);\n    let binToWeek = this.state.binToWeekColDef;\n    let markdown_id = this.state.selectedRows.map((data, i) => {\n      return data.markdown_id;\n    });\n    console.log(markdown_id, 'markdown_id', weekToBin, 'weekToBin', binToWeek);\n  };\n  render() {\n    console.log(this.props.markdownDetails, 'markdownDetails');\n    const imageArray = [\n      card1Image,\n      card2Image,\n      card3Image,\n      card4Image,\n      card1Image,\n      card2Image,\n      card3Image,\n      card4Image,\n      card1Image,\n      card2Image,\n    ];\n    const cardStyle = [\n      'card-border1',\n      'card-border2',\n      'card-border3',\n      'card-border4',\n      'card-border1',\n      'card-border2',\n      'card-border3',\n      'card-border4',\n      'card-border1',\n      'card-border2',\n    ];\n\n    return (\n      <LoadingOverlay\n        loader={this.props.getOverlayLoaderState || this.state.KPILoader || this.state.tableLoader}\n        spinner>\n        <div className=\"createMd pl-2 pr-2 summary-comp\">\n          <div className=\"card CalendarMain promoCalendarDiv1 mt-3\">\n            <div>\n              <h4 className=\"font-size-14  pad-10 markdown-heading\">\n                MarkSmart /<span className=\"font-bold color-blue\">Summary</span>\n              </h4>\n            </div>\n            <hr\n              className=\"mb-2\"\n              style={{\n                marginTop: '-4px',\n              }}\n            />\n            <div className=\"filterCol mb-4\">\n              <Filters\n                storeClusterDisable={true}\n                onReset={(e) => {\n                  this.setState({\n                    textStr: 'Please select filters to show Markdown plans',\n                    showKPIS: false,\n                  });\n                  this.props.onResetSummaryTable();\n                }}\n                hierarchy={this.state.filters}\n                onFilter={this.onFilter}\n                dateRange\n                filtersOptions={[\n                  { type: 'country', isMandatory: true, isMultiple: false },\n                  { type: 'channel', isMandatory: true, isMultiple: false },\n                  { type: 'storeCluster', isMandatory: false, isMultiple: true },\n                  { type: 'customStoreGroup', isMandatory: false, isMultiple: true },\n                  { type: 'store', isMandatory: false, isMultiple: true },\n                  {\n                    type: 'hierarchy1',\n                    isMandatory: true,\n                    isMultiple: false,\n                    isHierarchy: true,\n                  },\n                  {\n                    type: 'hierarchy2',\n                    isMandatory: true,\n                    isMultiple: false,\n                    isHierarchy: true,\n                  },\n                  {\n                    type: 'hierarchy3',\n                    isMandatory: true,\n                    isMultiple: false,\n                    isHierarchy: true,\n                  },\n                  {\n                    type: 'hierarchy4',\n                    isMandatory: true,\n                    isMultiple: false,\n                    isHierarchy: true,\n                  },\n                  {\n                    type: 'hierarchy5',\n                    isMandatory: true,\n                    isMultiple: false,\n                    isHierarchy: true,\n                  },\n                  { type: 'season', isMandatory: false, isMultiple: true },\n                  { type: 'matrix', isMandatory: false, isMultiple: true },\n                  { type: 'exclusionList', isMandatory: false, isMultiple: true },\n                  { type: 'clearance', isMandatory: false, isMultiple: true },\n                  { type: 'customStyleGroup', isMandatory: false, isMultiple: true },\n                  { type: 'styleColor', isMandatory: false, isMultiple: true },\n                ]}\n              />\n            </div>\n          </div>\n          {/* <div className=\"row\" style={{ marginTop: '15px' }}>\n            {this.props.summaryKPIData.map((summaryKPIData) => (\n              <div className=\"col-md-3 col-sm-3 col-xs-6 p-2\">\n                <CardComponent\n                  cardImage={summaryKPIData.cardImage}\n                  cardText={this.state.firstCardText}\n                  cardValue={summaryKPIData.cardValue}\n                  cardValueSecond={summaryKPIData.cardValueSecond}\n                  cardWeekText={this.state.cardWeekText}\n                  cardMonthText={this.state.cardMonthText}\n                  cardStyles={{\n                    cardClass: summaryKPIData.cardStyleClass,\n                    cardValue: 'card1-value',\n                    cardImg: summaryKPIData.cardStyleImg,\n                    cardValueSecond: 'card-value-second',\n                    cardSubHeading: 'card-subHeading',\n                  }}\n                />\n              </div>\n            ))}\n          </div> */}\n          {/* <div className=\"row\" style={{ marginTop: '15px' }}> */}\n          {this.props.summaryKPIData && this.state.showKPIS ? (\n            // <div className=\"cardContainerstyle\" style={{ marginTop: '10px' }}>\n            <div className=\"cardContainerstyle\">\n              {this.props.summaryKPIData &&\n                this.props.summaryKPIData.columnMapping &&\n                Array.isArray(Object.keys(this.props.summaryKPIData.columnMapping)) &&\n                Object.keys(this.props.summaryKPIData.columnMapping).map((key, index) => (\n                  // <div className=\"col-md-3 col-sm-3 col-xs-6 p-2\">\n                  <div>\n                    <CardComponent\n                      cardImage={imageArray[index]}\n                      //item.type && item.type.charAt(0).toUpperCase() + item.type.slice(1);\n                      //cardText={key && key.charAt(0).toUpperCase() + key.slice(1)}\n                      cardText={\n                        this.props.summaryKPIData.columnMapping &&\n                        this.props.summaryKPIData.columnMapping[key] &&\n                        this.props.summaryKPIData.columnMapping[key].charAt(0) +\n                          this.props.summaryKPIData.columnMapping[key].slice(1).toLowerCase()\n                      }\n                      cardValue={\n                        this.props.summaryKPIData.KPIS.lw &&\n                        this.roundOffNumber(this.props.summaryKPIData.KPIS.lw[key], key)\n                      }\n                      cardValueSecond={\n                        this.props.summaryKPIData.KPIS.tw &&\n                        this.roundOffNumber(this.props.summaryKPIData.KPIS.tw[key], key)\n                      }\n                      cardValueThird={\n                        this.props.summaryKPIData.KPIS.total &&\n                        this.roundOffNumber(this.props.summaryKPIData.KPIS.total[key], key)\n                      }\n                      cardWeekText={this.state.cardWeekText}\n                      cardMonthText={this.state.cardMonthText}\n                      cardTotalText={this.state.cardTotalText}\n                      cardStyles={{\n                        cardClass: cardStyle[index],\n                        //cardValue: 'card1-value',\n                        //cardImg: summaryKPIData.cardStyleImg,\n                        //cardValueSecond: 'card-value-second',\n                        //cardSubHeading: 'card-subHeading',\n                      }}\n                    />\n                  </div>\n                ))}\n            </div>\n          ) : null}\n          {!_.isEmpty(this.props.detailedSummary) || !_.isEmpty(this.state.aggTableData) ? (\n            <div className=\"card pt-3 px-3 mt-3\">\n              <ColSelBtn>\n                {((this.state.switchedPlans && !_.isEmpty(this.state.columns)) ||\n                  (!this.state.switchedPlans && !_.isEmpty(this.state.aggColDef))) && (\n                  <ColumnSelection\n                    onHandleSelect={this.onHandleSelect}\n                    columnOptions={this.state.columnOptions}\n                    selectedItems={this.state.selectedItems}\n                    selLabels={this.state.selLabels}\n                  />\n                )}\n                <div className=\"switchCss\">\n                  <Switch\n                    checked={this.state.switchedPlans}\n                    onSwitchHandler={this.isSwitchedPaln}\n                    leftLabel=\"Aggregated\"\n                    rightLabel=\"Detailed\"\n                  />\n                </div>\n                <div style={{ padding: '1rem' }}>\n                  <button\n                    className=\"btn btn-primary\"\n                    // disabled={true}\n                    onClick={this.onCopyRefreshed}>\n                    Copy Refreshed\n                  </button>\n                  &nbsp;\n                  <button\n                    // disabled={true}\n                    className=\"btn btn-primary\"\n                    onClick={this.onSaveAndResimulate}>\n                    Save\n                  </button>\n                </div>\n              </ColSelBtn>\n              {this.state.switchedPlans ? (\n                <DataTable\n                  columns={this.state.columns}\n                  isSort={true}\n                  data={this.props.detailedSummary}\n                  updateMyData={this.updateMyData}\n                  isPagination={true}\n                  rowsPerPage={5}\n                  getCellProps={(cellInfo) => ({\n                    style: {\n                      backgroundColor: this.bgmCol(cellInfo),\n                      color: this.txtCol(cellInfo),\n                      margin: '4px 4px',\n                      borderRadius: '2px',\n                    },\n                  })}\n                />\n              ) : (\n                <DataTable\n                  columns={this.state.aggColDef}\n                  isSort={true}\n                  data={this.state.aggTableData.week_to_bin_agg_data}\n                  updateMyData={this.updateMyData}\n                  isPagination={true}\n                  rowsPerPage={5}\n                  renderRowSubComponent={this.renderRowSubComponent}\n                  nextPageHandler={this.nextPageHandler}\n                  getCellProps={(cellInfo) => ({\n                    style: {\n                      backgroundColor: this.bgmCol(cellInfo),\n                      color: this.txtCol(cellInfo),\n                      margin: '4px 4px',\n                      borderRadius: '2px',\n                    },\n                    onClick: (e) => {\n                      //added to track on which cell user has clicked\n                      let classList = e.target.classList;\n                      if (\n                        classList &&\n                        !(\n                          classList.contains('expanded-icon-size') ||\n                          classList.contains('summary-table-icon')\n                        )\n                      )\n                        //user clicks on div(i.e, row is not expanded)  then return\n                        return;\n\n                      if (cellInfo.column.id === 'expander')\n                        //expander is Date Range cell\n                        this.expandedRowDetailsHandler(cellInfo.row.original, 'week_to_bin');\n                      else if (cellInfo.column.id === 'expander1')\n                        //expander1 is Bins cell\n                        this.expandedRowDetailsHandler(cellInfo.row.original, 'bin_to_week');\n                    },\n                  })}\n                  RowCheck={({ row, column }) => {\n                    if (!(column.id === 'expander' || column.id === 'expander1')) return;\n                    //disables sibling cell within a row, when a particular row is expanded\n                    let foundLevel = _.filter(this.state.expandedRowDetails, {\n                      markdown_id: row.original.markdown_id,\n                    });\n                    if (!foundLevel[0]) return;\n\n                    return (foundLevel[0].level === 'week_to_bin' && column.id === 'expander1') ||\n                      (foundLevel[0].level === 'bin_to_week' && column.id === 'expander')\n                      ? 'tdtd disable-summary-cell'\n                      : null;\n                  }}\n                />\n              )}\n            </div>\n          ) : (\n            <NoData description={this.state.textStr} />\n          )}\n        </div>\n      </LoadingOverlay>\n    );\n  }\n}\n\nconst mapStateToProps = (store) => {\n  return {\n    finalizeMarkdownData: store.draftStatusReducer.markdowns,\n    getOverlayLoaderState: store.loaderReducer.overlayLoaderState,\n    getOverlayLoaderText: store.loaderReducer.loaderText,\n    getColumnHeaders: store.draftStatusReducer.columnHeaders,\n    getMetricOptions: store.finalizeReducer.metricOptions,\n    selectedHierarchy1: store.filtersReducer.selectedHierarchy1,\n    selectedHierarchy2: store.filtersReducer.selectedHierarchy2,\n    selectedHierarchy3: store.filtersReducer.selectedHierarchy3,\n    selectedHierarchy4: store.filtersReducer.selectedHierarchy4,\n    selectedHierarchy5: store.filtersReducer.selectedHierarchy5,\n    startDate: store.filtersReducer.startDate,\n    endDate: store.filtersReducer.endDate,\n    weeks: store.filtersReducer.weeks,\n\n    selectedSeason: store.filtersReducer.selectedSeason,\n    selectedClearance: store.filtersReducer.selectedClearance,\n    selectedMatrix: store.filtersReducer.selectedMatrix,\n    selectedExclusionList: store.filtersReducer.selectedExclusionList,\n    selectedStyleColor: store.filtersReducer.selectedStyleColor,\n    selectedCountry: store.filtersReducer.selectedCountry,\n    selectedStoreCluster: store.filtersReducer.selectedStoreCluster,\n    selectedStore: store.filtersReducer.selectedStore,\n    selectedChannel: store.filtersReducer.selectedChannel,\n    markdownDetails: store.summaryMDReducer.markdownDetails,\n    summaryKPIData: store.summaryMDReducer.summaryKPIData,\n    detailedSummary: store.summaryMDReducer.detailedSummary,\n    aggregatedSummary: store.summaryMDReducer.aggregatedSummary,\n  };\n};\n\nconst mapActionToProps = {\n  getSummaryDetails: SummaryAction.getSummaryDetails,\n  getSummaryAggregated: SummaryAction.getSummaryAggregated,\n  onResetSummaryTable: SummaryAction.onResetSummaryTable,\n  getKPIdata: SummaryAction.getKPIdata,\n  updateSidebar: plannedReportsAction.updateSidebar,\n  setRetainFilters: filterActions.setRetainFilters,\n  sendResimulateAndSave: SummaryAction.sendResimulateAndSave,\n};\nexport default connect(mapStateToProps, mapActionToProps)(withRouter(Summary));\nconst ColSelBtn = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n`;\n"]},"metadata":{},"sourceType":"module"}