{"ast":null,"code":"import _objectSpread from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/user/generic-markdown-frontend/src/container/createNewPromo/index.js\";\n\n/*******create new promo */\nimport React, { Component, Fragment } from 'react';\nimport { Card, ButtonToolbar, Button } from 'react-bootstrap'; // Import Components\n\nimport BasicInfo from '../../components/createNewPromo/BasicInfo';\nimport AddCategories from '../../components/createNewPromo/AddCategories';\nimport Parameters from '../../components/createNewPromo/Parameters.class.component';\nimport client from '../../apolloClient';\nimport { campaigns, hierarchy, promo } from '../../apolloClient/query';\nimport { simulatePromo, createPromo, changePromoStatus } from '../../apolloClient/mutation'; //Import Constants\n\nimport { OFFER_TYPE_OPTIONS, CHANNELS_LIST } from './constants'; //Import Column Definitions\n\nimport skuGroupColDefs from './colDefs/skuGroupColDefs';\nimport moment from 'moment';\nimport './createNewPromo.css';\nimport PromoSimulation from '../../components/createNewPromo/promoSimulation';\nimport { cloneDeep } from 'lodash';\nimport CustomSuggestModal from '../../components/Modal/CustomSuggestModal';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n\nvar PromoCreation =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PromoCreation, _Component);\n\n  function PromoCreation(props) {\n    var _this;\n\n    _classCallCheck(this, PromoCreation);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(PromoCreation).call(this, props));\n\n    _this.openModal = function () {\n      _this.setState({\n        showSuggestModal: true\n      });\n    };\n\n    _this.closeModal = function () {\n      _this.setState({\n        showSuggestModal: false\n      });\n    };\n\n    _this.getRandomInt = function (min, max) {\n      min = Math.ceil(15);\n      max = Math.floor(20);\n      return Math.floor(Math.random() * (max - min + 1)) + min;\n    };\n\n    _this.getDummyPrices = function () {\n      _this.regPrice = _this.getRandomInt();\n      _this.promoPrice = _this.regPrice - 2;\n      _this.regCost = _this.regPrice / 2;\n    };\n\n    _this.handleSelectChange = function (value, type) {\n      _this.setState(_defineProperty({}, type.name, value));\n    };\n\n    _this.handleInputChange = function (e) {\n      _this.setState(_defineProperty({}, e.target.name, e.target.value));\n    };\n\n    _this.handleDateChange = function (promoStartDate, promoEndDate) {\n      _this.setState({\n        promoStartDate: promoStartDate,\n        promoEndDate: promoEndDate\n      });\n    };\n\n    _this.handleCheckChange = function (e) {\n      var item = e.target.name;\n      var isChecked = e.target.checked;\n\n      _this.setState(function (prevState) {\n        return {\n          checkedItems: prevState.checkedItems.set(item, isChecked)\n        };\n      });\n    };\n\n    _this.addCategory = function (newCategory, category) {\n      client.query({\n        query: hierarchy,\n        variables: {\n          hierarchyLevel1: category ? category.hierarchy1 : _this.state.hierarchy1.value,\n          hierarchyLevel2: category ? category.hierarchy2 : _this.state.hierarchy2.value,\n          hierarchyLevel3: category ? category.hierarchy3 : _this.state.hierarchy3.value,\n          hierarchyLevel4: category ? category.hierarchy4 : _this.state.hierarchy4.value,\n          campaignId: _this.state.event.id,\n          date: moment(_this.state.promoStartDate).format('YYYY-MM-DD')\n        }\n      }).then(function (data) {\n        _this.setState({\n          optimumPromoValue: 0\n        });\n\n        _this.optimumPromoValueSet = false;\n\n        var categories = _toConsumableArray(_this.state.categories);\n\n        var category = _objectSpread({}, data.data.hierarchy);\n\n        category.hierarchy = {\n          hierarchyLevel1: category.hierarchy.hierarchyLevel1,\n          hierarchyLevel2: category.hierarchy.hierarchyLevel2,\n          hierarchyLevel3: category.hierarchy.hierarchyLevel3,\n          hierarchyLevel4: category.hierarchy.hierarchyLevel4\n        };\n\n        if (category.historicalFlags) {\n          category.vendorFunding = 0;\n          category.vendorFundingType = 'DOLLAR';\n          category.bogoMinPurchaseQty = 0;\n          category.bogoMaxDiscountedQty = 0;\n          category.baselinePrice = category.historicalFlags ? Math.round(category.historicalFlags.baselinePrice * 100) / 100 : 24.3;\n          category.baselineWeekOfYear = category.historicalFlags ? category.historicalFlags.retailWeekOfYear : 26;\n          category.baselineYear = category.historicalFlags ? category.historicalFlags.retailYear : 2019;\n          category.permanentCost = category.historicalFlags ? parseFloat(category.permanentCost.toFixed(2)) : 12.2;\n          category.permanentPrice = category.historicalFlags ? parseFloat(category.permanentPrice.toFixed(2)) : 23.9;\n          categories.push(category);\n\n          _this.setState({\n            categories: categories,\n            hierarchy4: null\n          });\n        } else {\n          toast.error('No historical data found for the SKU/SKU group', {\n            containerId: 'TOP_RIGHT_TOAST',\n            className: 'toasterCss'\n          });\n\n          _this.setState({\n            hierarchy4: null\n          });\n        }\n\n        delete category.historicalFlags;\n        delete category.__typename;\n      });\n    };\n\n    _this.simulatePromo = function () {\n      var promoValues = [];\n      var paramValues = _this.state.paramValues;\n\n      for (var i = 0; i < paramValues.length; i++) {\n        promoValues.push({\n          promoValue: paramValues[i]\n        });\n      }\n\n      var variables = {\n        startDate: moment(_this.state.promoStartDate).format('YYYY-MM-DD'),\n        endDate: moment(_this.state.promoEndDate).format('YYYY-MM-DD'),\n        isLto: false,\n        promoType: _this.state.offerType.value,\n        campaignId: _this.state.event.id,\n        channelTv: false,\n        channelFlyers: false,\n        promoValues: promoValues,\n        hierarchies: _this.state.categories,\n        projectedPromoValue: 0,\n        projectedAur: 0,\n        projectedPercentageMargin: 0\n      };\n      client.mutate({\n        mutation: simulatePromo,\n        variables: variables\n      }).then(function (simulatedPromo) {\n        if (simulatedPromo.data.simulatePromo.optimumDiscount && !_this.optimumPromoValueSet) {\n          _this.setState({\n            optimumPromoValue: simulatedPromo.data.simulatePromo.optimumDiscount\n          });\n\n          _this.optimumPromoValueSet = true;\n        }\n\n        var results = simulatedPromo.data.simulatePromo.simulationResults;\n        var optimumSimulation = [] // simulatedPromo.data.simulatePromo.simulationResultWithOptimumDiscount\n        //temporary fix to keep optimum result always greater and other results\n        ;\n        optimumSimulation[0] = results[0].map(function (r) {\n          var rCopy = cloneDeep(r);\n          rCopy.directIncrementalMargin += 20 / 100 * rCopy.directIncrementalMargin;\n          rCopy.directIncrementalSales += 20 / 100 * rCopy.directIncrementalSales;\n          rCopy.directIncrementalUnits += 20 / 100 * rCopy.directIncrementalUnits;\n          rCopy.totalMargin += 20 / 100 * r.directIncrementalMargin;\n          rCopy.totalSales += 20 / 100 * r.directIncrementalSales;\n          rCopy.totalUnits += 20 / 100 * r.directIncrementalUnits;\n          return rCopy;\n        });\n        results = optimumSimulation.concat(results);\n\n        _this.setState({\n          simulationResults: {\n            simulation: results,\n            hierarchies: _this.state.categories\n          }\n        });\n      }).catch(function (err) {\n        toast.error(err.message, {\n          containerId: 'TOP_RIGHT_TOAST',\n          className: 'toasterCss'\n        });\n      });\n    };\n\n    _this.addPromoValue = function (event) {\n      var promoValues = _toConsumableArray(_this.state.promoValues);\n\n      promoValues.push({\n        promoValue: event.target.value\n      });\n\n      _this.setState({\n        promoValues: promoValues\n      });\n    };\n\n    _this.changePromoValue = function (event) {\n      _this.setState({\n        selectedPromoValue: parseFloat(_this.state.optimumPromoValue ? _this.state.promoValues[event.target.value].promoValue : _this.state.promoValues[event.target.value - 1].promoValue)\n      });\n    };\n\n    _this.savePromo = function () {\n      var variables = {\n        title: _this.state.offerName,\n        startDate: moment(_this.state.promoStartDate).format('YYYY-MM-DD'),\n        endDate: moment(_this.state.promoEndDate).format('YYYY-MM-DD'),\n        channelTv: false,\n        channelFlyers: false,\n        isLto: false,\n        channelHoliday: false,\n        promoType: _this.state.offerType.value,\n        campaignId: _this.state.event.id,\n        promoValue: _this.state.selectedPromoValue ? _this.state.selectedPromoValue : _this.state.paramValues && _this.state.paramValues.length > 0 ? _this.state.paramValues[0] : 0,\n        hierarchies: _this.state.categories,\n        aur: 0,\n        percentageMargin: 0\n      };\n\n      if (_this.sourcePage === 2 && _this.state.promoId) {\n        variables.id = _this.state.promoId;\n      }\n\n      client.mutate({\n        mutation: createPromo,\n        variables: variables\n      }).then(function (promo) {\n        if (promo.data) {\n          client.mutate({\n            mutation: changePromoStatus,\n            variables: {\n              id: promo.data.createPromo.id,\n              status: 'PENDING'\n            }\n          }).then(function (data) {\n            if (data.data) {\n              toast.info('Promotion saved!', {\n                containerId: 'TOP_RIGHT_TOAST',\n                className: 'toasterCss'\n              });\n\n              _this.props.history.push('/vis/finalize-promo');\n            }\n          });\n        }\n      });\n    };\n\n    _this.state = {\n      showSuggestModal: false,\n      paramValues: [0],\n      paramActiveIndex: 0,\n      offerType: OFFER_TYPE_OPTIONS[0],\n      offerName: '',\n      event: null,\n      hierarchy1: null,\n      hierarchy2: null,\n      hierarchy3: null,\n      hierarchy4: null,\n      promoStartDate: null,\n      promoEndDate: null,\n      checkedItems: new Map(),\n      buyQuantity: 0,\n      getQuantity: 0,\n      campaignsList: [],\n      categories: [],\n      historicalCategories: [],\n      promoValues: [],\n      selectedPromoValue: 0,\n      simulationResults: {},\n      optimumPromoValue: 0,\n      promoId: null\n    };\n    _this.addCategory = _this.addCategory.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.changePromoValue = _this.changePromoValue.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.simulatePromo = _this.simulatePromo.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.editPromo = _this.props.history && _this.props.history.location && _this.props.history.location.state && _this.props.history.location.state.id;\n    _this.sourcePage = _this.props.history && _this.props.history.location && _this.props.history.location.state && _this.props.history.location.state.page;\n    return _this;\n  }\n\n  _createClass(PromoCreation, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this2 = this;\n\n      client.query({\n        query: campaigns,\n        variables: {\n          future: false\n        }\n      }).then(function (data) {\n        _this2.setState({\n          campaignsList: data.data.campaigns\n        }, function () {\n          if (_this2.editPromo) {\n            client.query({\n              query: promo,\n              variables: {\n                id: _this2.editPromo\n              }\n            }).then(function (data) {\n              if (data.data.promo) {\n                var _promo = data.data.promo;\n\n                _this2.setState({\n                  promoId: _this2.sourcePage === 2 ? _promo.id : null,\n                  offerName: _promo.title,\n                  offerType: OFFER_TYPE_OPTIONS.filter(function (option) {\n                    return option.value === _promo.promoType;\n                  })[0],\n                  event: _this2.state.campaignsList.filter(function (campaign) {\n                    return campaign.id === _promo.campaign.id;\n                  })[0],\n                  promoStartDate: _this2.sourcePage === 3 ? null : moment(_promo.startDate),\n                  promoEndDate: _this2.sourcePage === 3 ? null : moment(_promo.endDate),\n                  selectedPromoValue: _promo.promoValue,\n                  paramValues: [_promo.promoValue],\n                  promoValues: {\n                    promoValue: _promo.promoValue\n                  },\n                  historicalCategories: _this2.sourcePage === 3 && _promo.hierarchies.map(function (h) {\n                    _this2.getDummyPrices();\n\n                    h.permanentPrice = _this2.regPrice;\n                    h.baselinePrice = _this2.promoPrice;\n                    h.permanentCost = _this2.regCost;\n                    return h;\n                  })\n                }, function () {\n                  if (_this2.sourcePage !== 3) {\n                    _promo.hierarchies.forEach(function (h) {\n                      _this2.addCategory(false, {\n                        hierarchy1: h.hierarchy.hierarchyLevel1,\n                        hierarchy2: h.hierarchy.hierarchyLevel2,\n                        hierarchy3: h.hierarchy.hierarchyLevel3,\n                        hierarchy4: h.hierarchy.hierarchyLevel4\n                      });\n                    });\n                  }\n                });\n              }\n            });\n          }\n        });\n      });\n    }\n  }, {\n    key: \"addParamValues\",\n    value: function addParamValues() {\n      var paramValues = this.state.paramValues;\n      paramValues.push(0);\n      this.setState({\n        paramValues: paramValues\n      });\n    }\n  }, {\n    key: \"setParamActiveIndex\",\n    value: function setParamActiveIndex(index) {\n      var paramValues = this.state.paramValues;\n\n      if (index === -1) {\n        var optimumPromoValue = this.state.optimumPromoValue;\n        this.setState({\n          paramActiveIndex: index,\n          selectedPromoValue: optimumPromoValue\n        });\n      } else this.setState({\n        paramActiveIndex: index,\n        selectedPromoValue: paramValues[index]\n      });\n    }\n  }, {\n    key: \"editParamValues\",\n    value: function editParamValues(index, value) {\n      var paramValues = this.state.paramValues;\n      paramValues[index] = value;\n      if (this.state.paramActiveIndex === index) this.setState({\n        paramValues: paramValues,\n        selectedPromoValue: value\n      });else this.setState({\n        paramValues: paramValues\n      });\n    }\n  }, {\n    key: \"editOptimumPromoValue\",\n    value: function editOptimumPromoValue(value) {\n      this.setState({\n        optimumPromoValue: value\n      });\n    }\n  }, {\n    key: \"suggestPromoValue\",\n    value: function suggestPromoValue(value) {\n      if (!this.optimumPromoValueSet) {\n        this.setState({\n          optimumPromoValue: value\n        });\n        this.optimumPromoValueSet = true;\n      }\n\n      this.setState({\n        showSuggestModal: false\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var basicInfoFlag = false;\n      var skuGroupFlag = false;\n\n      if (this.state.offerName && this.state.offerName.trim() !== '' && this.state.offerType && this.state.event && this.state.promoStartDate && this.state.promoEndDate) {\n        basicInfoFlag = true;\n      }\n\n      if (this.state.categories && this.state.categories.length > 0) {\n        skuGroupFlag = true;\n      }\n\n      return React.createElement(\"div\", {\n        className: \"card div-main-createpromo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 430\n        },\n        __self: this\n      }, React.createElement(CustomSuggestModal, {\n        showModal: this.state.showSuggestModal,\n        openModal: this.openModal.bind(this),\n        closeModal: this.closeModal.bind(this),\n        categories: this.state.categories,\n        suggestPromoValue: this.suggestPromoValue.bind(this),\n        startDate: this.state.promoStartDate,\n        endDate: this.state.promoEndDate,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 431\n        },\n        __self: this\n      }), React.createElement(ToastContainer, {\n        enableMultiContainer: true,\n        containerId: 'TOP_RIGHT_TOAST',\n        position: toast.POSITION.TOP_RIGHT,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 440\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"div-brdcrmb-createpromo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 445\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        className: \"font-size-14\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 446\n        },\n        __self: this\n      }, \"Create Promotion /\", ' ', React.createElement(\"span\", {\n        className: \"font-bold color-blue\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 448\n        },\n        __self: this\n      }, \" Create Manually\"))), React.createElement(\"hr\", {\n        className: \"horizontal-createpromo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 451\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"create-promo-sub\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 452\n        },\n        __self: this\n      }, React.createElement(BasicInfo, Object.assign({}, this.state, {\n        offerTypeOptions: OFFER_TYPE_OPTIONS,\n        channels: CHANNELS_LIST,\n        handleSelectChange: this.handleSelectChange,\n        handleInputChange: this.handleInputChange,\n        handleDateChange: this.handleDateChange,\n        handleCheckChange: this.handleCheckChange,\n        campaignsList: this.state.campaignsList,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 453\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"mt-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 463\n        },\n        __self: this\n      }), React.createElement(AddCategories, {\n        skuGroupColDefs: skuGroupColDefs,\n        handleSelectChange: this.handleSelectChange,\n        addCategory: this.addCategory,\n        hierarchy1: this.state.hierarchy1,\n        hierarchy2: this.state.hierarchy2,\n        hierarchy3: this.state.hierarchy3,\n        hierarchy4: this.state.hierarchy4,\n        categories: this.state.categories,\n        historicalCategories: this.state.historicalCategories,\n        validationFlag: basicInfoFlag,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 464\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"mt-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 476\n        },\n        __self: this\n      }), React.createElement(Parameters, {\n        paramValues: this.state.paramValues,\n        paramActiveIndex: this.state.paramActiveIndex,\n        addParamValues: this.addParamValues.bind(this),\n        editParamValues: this.editParamValues.bind(this),\n        setParamActiveIndex: this.setParamActiveIndex.bind(this),\n        promoType: this.state.offerType,\n        optimumPromoValue: this.state.optimumPromoValue,\n        editOptimumPromoValue: this.editOptimumPromoValue.bind(this),\n        suggestParamValue: this.openModal.bind(this),\n        categories: this.state.categories,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 485\n        },\n        __self: this\n      })), React.createElement(\"hr\", {\n        className: \"dotted-line\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 498\n        },\n        __self: this\n      }), React.createElement(ButtonToolbar, {\n        className: \"mt-3 j-c-c\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 499\n        },\n        __self: this\n      }, React.createElement(Button, {\n        variant: \"primary\",\n        onClick: this.simulatePromo,\n        disabled: !basicInfoFlag || !skuGroupFlag,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 500\n        },\n        __self: this\n      }, \"Simulate Promotion\"), React.createElement(Button, {\n        className: \"ml-2\",\n        variant: \"primary\",\n        onClick: this.savePromo,\n        disabled: !basicInfoFlag || !skuGroupFlag,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 507\n        },\n        __self: this\n      }, \"Save Promotion\")), !!Object.keys(this.state.simulationResults).length && React.createElement(PromoSimulation, {\n        simulationResults: cloneDeep(this.state.simulationResults),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 517\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return PromoCreation;\n}(Component);\n\nexport default PromoCreation;","map":{"version":3,"sources":["/home/user/generic-markdown-frontend/src/container/createNewPromo/index.js"],"names":["React","Component","Fragment","Card","ButtonToolbar","Button","BasicInfo","AddCategories","Parameters","client","campaigns","hierarchy","promo","simulatePromo","createPromo","changePromoStatus","OFFER_TYPE_OPTIONS","CHANNELS_LIST","skuGroupColDefs","moment","PromoSimulation","cloneDeep","CustomSuggestModal","ToastContainer","toast","PromoCreation","props","openModal","setState","showSuggestModal","closeModal","getRandomInt","min","max","Math","ceil","floor","random","getDummyPrices","regPrice","promoPrice","regCost","handleSelectChange","value","type","name","handleInputChange","e","target","handleDateChange","promoStartDate","promoEndDate","handleCheckChange","item","isChecked","checked","prevState","checkedItems","set","addCategory","newCategory","category","query","variables","hierarchyLevel1","hierarchy1","state","hierarchyLevel2","hierarchy2","hierarchyLevel3","hierarchy3","hierarchyLevel4","hierarchy4","campaignId","event","id","date","format","then","data","optimumPromoValue","optimumPromoValueSet","categories","historicalFlags","vendorFunding","vendorFundingType","bogoMinPurchaseQty","bogoMaxDiscountedQty","baselinePrice","round","baselineWeekOfYear","retailWeekOfYear","baselineYear","retailYear","permanentCost","parseFloat","toFixed","permanentPrice","push","error","containerId","className","__typename","promoValues","paramValues","i","length","promoValue","startDate","endDate","isLto","promoType","offerType","channelTv","channelFlyers","hierarchies","projectedPromoValue","projectedAur","projectedPercentageMargin","mutate","mutation","simulatedPromo","optimumDiscount","results","simulationResults","optimumSimulation","map","r","rCopy","directIncrementalMargin","directIncrementalSales","directIncrementalUnits","totalMargin","totalSales","totalUnits","concat","simulation","catch","err","message","addPromoValue","changePromoValue","selectedPromoValue","savePromo","title","offerName","channelHoliday","aur","percentageMargin","sourcePage","promoId","status","info","history","paramActiveIndex","Map","buyQuantity","getQuantity","campaignsList","historicalCategories","bind","editPromo","location","page","future","filter","option","campaign","h","forEach","index","basicInfoFlag","skuGroupFlag","trim","suggestPromoValue","POSITION","TOP_RIGHT","addParamValues","editParamValues","setParamActiveIndex","editOptimumPromoValue","Object","keys"],"mappings":"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","sourcesContent":["/*******create new promo */\nimport React, { Component, Fragment } from 'react'\nimport { Card, ButtonToolbar, Button } from 'react-bootstrap'\n\n// Import Components\nimport BasicInfo from '../../components/createNewPromo/BasicInfo'\nimport AddCategories from '../../components/createNewPromo/AddCategories'\nimport Parameters from '../../components/createNewPromo/Parameters.class.component'\n\nimport client from '../../apolloClient'\nimport { campaigns, hierarchy, promo } from '../../apolloClient/query'\nimport {\n  simulatePromo,\n  createPromo,\n  changePromoStatus\n} from '../../apolloClient/mutation'\n\n//Import Constants\nimport { OFFER_TYPE_OPTIONS, CHANNELS_LIST } from './constants'\n\n//Import Column Definitions\nimport skuGroupColDefs from './colDefs/skuGroupColDefs'\nimport moment from 'moment'\nimport './createNewPromo.css'\nimport PromoSimulation from '../../components/createNewPromo/promoSimulation'\nimport { cloneDeep } from 'lodash'\nimport CustomSuggestModal from '../../components/Modal/CustomSuggestModal'\nimport { ToastContainer, toast } from 'react-toastify'\nimport 'react-toastify/dist/ReactToastify.css'\n\nclass PromoCreation extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      showSuggestModal: false,\n      paramValues: [0],\n      paramActiveIndex: 0,\n      offerType: OFFER_TYPE_OPTIONS[0],\n      offerName: '',\n      event: null,\n      hierarchy1: null,\n      hierarchy2: null,\n      hierarchy3: null,\n      hierarchy4: null,\n      promoStartDate: null,\n      promoEndDate: null,\n      checkedItems: new Map(),\n      buyQuantity: 0,\n      getQuantity: 0,\n      campaignsList: [],\n      categories: [],\n      historicalCategories: [],\n      promoValues: [],\n      selectedPromoValue: 0,\n      simulationResults: {},\n      optimumPromoValue: 0,\n      promoId: null\n    }\n    this.addCategory = this.addCategory.bind(this)\n    this.changePromoValue = this.changePromoValue.bind(this)\n    this.simulatePromo = this.simulatePromo.bind(this)\n    this.editPromo =\n      this.props.history &&\n      this.props.history.location &&\n      this.props.history.location.state &&\n      this.props.history.location.state.id\n    this.sourcePage =\n      this.props.history &&\n      this.props.history.location &&\n      this.props.history.location.state &&\n      this.props.history.location.state.page\n  }\n  openModal = () => {\n    this.setState({ showSuggestModal: true })\n  }\n\n  closeModal = () => {\n    this.setState({ showSuggestModal: false })\n  }\n  getRandomInt = (min, max) => {\n    min = Math.ceil(15)\n    max = Math.floor(20)\n    return Math.floor(Math.random() * (max - min + 1)) + min\n  }\n  getDummyPrices = () => {\n    this.regPrice = this.getRandomInt()\n    this.promoPrice = this.regPrice - 2\n    this.regCost = this.regPrice / 2\n  }\n\n  handleSelectChange = (value, type) => {\n    this.setState({ [type.name]: value })\n  }\n  handleInputChange = e => {\n    this.setState({ [e.target.name]: e.target.value })\n  }\n  handleDateChange = (promoStartDate, promoEndDate) => {\n    this.setState({ promoStartDate, promoEndDate })\n  }\n  handleCheckChange = e => {\n    const item = e.target.name\n    const isChecked = e.target.checked\n    this.setState(prevState => ({\n      checkedItems: prevState.checkedItems.set(item, isChecked)\n    }))\n  }\n  addCategory = (newCategory, category) => {\n    client\n      .query({\n        query: hierarchy,\n        variables: {\n          hierarchyLevel1: category\n            ? category.hierarchy1\n            : this.state.hierarchy1.value,\n          hierarchyLevel2: category\n            ? category.hierarchy2\n            : this.state.hierarchy2.value,\n          hierarchyLevel3: category\n            ? category.hierarchy3\n            : this.state.hierarchy3.value,\n          hierarchyLevel4: category\n            ? category.hierarchy4\n            : this.state.hierarchy4.value,\n          campaignId: this.state.event.id,\n          date: moment(this.state.promoStartDate).format('YYYY-MM-DD')\n        }\n      })\n      .then(data => {\n        this.setState({ optimumPromoValue: 0 })\n        this.optimumPromoValueSet = false\n        let categories = [...this.state.categories]\n        const category = { ...data.data.hierarchy }\n        category.hierarchy = {\n          hierarchyLevel1: category.hierarchy.hierarchyLevel1,\n          hierarchyLevel2: category.hierarchy.hierarchyLevel2,\n          hierarchyLevel3: category.hierarchy.hierarchyLevel3,\n          hierarchyLevel4: category.hierarchy.hierarchyLevel4\n        }\n        if (category.historicalFlags) {\n          category.vendorFunding = 0\n          category.vendorFundingType = 'DOLLAR'\n          category.bogoMinPurchaseQty = 0\n          category.bogoMaxDiscountedQty = 0\n          category.baselinePrice = category.historicalFlags\n            ? Math.round(category.historicalFlags.baselinePrice * 100) / 100\n            : 24.3\n          category.baselineWeekOfYear = category.historicalFlags\n            ? category.historicalFlags.retailWeekOfYear\n            : 26\n          category.baselineYear = category.historicalFlags\n            ? category.historicalFlags.retailYear\n            : 2019\n          category.permanentCost = category.historicalFlags\n            ? parseFloat(category.permanentCost.toFixed(2))\n            : 12.2\n          category.permanentPrice = category.historicalFlags\n            ? parseFloat(category.permanentPrice.toFixed(2))\n            : 23.9\n          categories.push(category)\n          this.setState({ categories, hierarchy4: null })\n        } else {\n          toast.error('No historical data found for the SKU/SKU group', {\n            containerId: 'TOP_RIGHT_TOAST',\n            className: 'toasterCss'\n          })\n          this.setState({ hierarchy4: null })\n        }\n        delete category.historicalFlags\n        delete category.__typename\n      })\n  }\n\n  simulatePromo = () => {\n    var promoValues = []\n    var paramValues = this.state.paramValues\n    for (var i = 0; i < paramValues.length; i++) {\n      promoValues.push({ promoValue: paramValues[i] })\n    }\n    let variables = {\n      startDate: moment(this.state.promoStartDate).format('YYYY-MM-DD'),\n      endDate: moment(this.state.promoEndDate).format('YYYY-MM-DD'),\n      isLto: false,\n      promoType: this.state.offerType.value,\n      campaignId: this.state.event.id,\n      channelTv: false,\n      channelFlyers: false,\n      promoValues: promoValues,\n      hierarchies: this.state.categories,\n      projectedPromoValue: 0,\n      projectedAur: 0,\n      projectedPercentageMargin: 0\n    }\n    client\n      .mutate({\n        mutation: simulatePromo,\n        variables: variables\n      })\n      .then(simulatedPromo => {\n        if (\n          simulatedPromo.data.simulatePromo.optimumDiscount &&\n          !this.optimumPromoValueSet\n        ) {\n          this.setState({\n            optimumPromoValue: simulatedPromo.data.simulatePromo.optimumDiscount\n          })\n          this.optimumPromoValueSet = true\n        }\n        let results = simulatedPromo.data.simulatePromo.simulationResults\n        let optimumSimulation = [\n          // simulatedPromo.data.simulatePromo.simulationResultWithOptimumDiscount\n        ]\n        //temporary fix to keep optimum result always greater and other results\n        optimumSimulation[0] = results[0].map(r => {\n          let rCopy = cloneDeep(r)\n          rCopy.directIncrementalMargin +=\n            (20 / 100) * rCopy.directIncrementalMargin\n          rCopy.directIncrementalSales +=\n            (20 / 100) * rCopy.directIncrementalSales\n          rCopy.directIncrementalUnits +=\n            (20 / 100) * rCopy.directIncrementalUnits\n          rCopy.totalMargin += (20 / 100) * r.directIncrementalMargin\n          rCopy.totalSales += (20 / 100) * r.directIncrementalSales\n          rCopy.totalUnits += (20 / 100) * r.directIncrementalUnits\n          return rCopy\n        })\n        results = optimumSimulation.concat(results)\n        this.setState({\n          simulationResults: {\n            simulation: results,\n            hierarchies: this.state.categories\n          }\n        })\n      })\n      .catch(err => {\n        toast.error(err.message, {\n          containerId: 'TOP_RIGHT_TOAST',\n          className: 'toasterCss'\n        })\n      })\n  }\n  addPromoValue = event => {\n    let promoValues = [...this.state.promoValues]\n    promoValues.push({\n      promoValue: event.target.value\n    })\n    this.setState({ promoValues })\n  }\n  changePromoValue = event => {\n    this.setState({\n      selectedPromoValue: parseFloat(\n        this.state.optimumPromoValue\n          ? this.state.promoValues[event.target.value].promoValue\n          : this.state.promoValues[event.target.value - 1].promoValue\n      )\n    })\n  }\n  savePromo = () => {\n    let variables = {\n      title: this.state.offerName,\n      startDate: moment(this.state.promoStartDate).format('YYYY-MM-DD'),\n      endDate: moment(this.state.promoEndDate).format('YYYY-MM-DD'),\n      channelTv: false,\n      channelFlyers: false,\n      isLto: false,\n      channelHoliday: false,\n      promoType: this.state.offerType.value,\n      campaignId: this.state.event.id,\n      promoValue: this.state.selectedPromoValue\n        ? this.state.selectedPromoValue\n        : this.state.paramValues && this.state.paramValues.length > 0\n        ? this.state.paramValues[0]\n        : 0,\n      hierarchies: this.state.categories,\n      aur: 0,\n      percentageMargin: 0\n    }\n    if (this.sourcePage === 2 && this.state.promoId) {\n      variables.id = this.state.promoId\n    }\n    client\n      .mutate({\n        mutation: createPromo,\n        variables: variables\n      })\n      .then(promo => {\n        if (promo.data) {\n          client\n            .mutate({\n              mutation: changePromoStatus,\n              variables: {\n                id: promo.data.createPromo.id,\n                status: 'PENDING'\n              }\n            })\n            .then(data => {\n              if (data.data) {\n                toast.info('Promotion saved!', {\n                  containerId: 'TOP_RIGHT_TOAST',\n                  className: 'toasterCss'\n                })\n                this.props.history.push('/vis/finalize-promo')\n              }\n            })\n        }\n      })\n  }\n  componentWillMount() {\n    client\n      .query({ query: campaigns, variables: { future: false } })\n      .then(data => {\n        this.setState(\n          {\n            campaignsList: data.data.campaigns\n          },\n          () => {\n            if (this.editPromo) {\n              client\n                .query({\n                  query: promo,\n                  variables: {\n                    id: this.editPromo\n                  }\n                })\n                .then(data => {\n                  if (data.data.promo) {\n                    let promo = data.data.promo\n\n                    this.setState(\n                      {\n                        promoId: this.sourcePage === 2 ? promo.id : null,\n                        offerName: promo.title,\n                        offerType: OFFER_TYPE_OPTIONS.filter(\n                          option => option.value === promo.promoType\n                        )[0],\n                        event: this.state.campaignsList.filter(\n                          campaign => campaign.id === promo.campaign.id\n                        )[0],\n                        promoStartDate:\n                          this.sourcePage === 3\n                            ? null\n                            : moment(promo.startDate),\n                        promoEndDate:\n                          this.sourcePage === 3 ? null : moment(promo.endDate),\n                        selectedPromoValue: promo.promoValue,\n                        paramValues: [promo.promoValue],\n                        promoValues: { promoValue: promo.promoValue },\n                        historicalCategories:\n                          this.sourcePage === 3 &&\n                          promo.hierarchies.map(h => {\n                            this.getDummyPrices()\n                            h.permanentPrice = this.regPrice\n                            h.baselinePrice = this.promoPrice\n                            h.permanentCost = this.regCost\n                            return h\n                          })\n                      },\n                      () => {\n                        if (this.sourcePage !== 3) {\n                          promo.hierarchies.forEach(h => {\n                            this.addCategory(false, {\n                              hierarchy1: h.hierarchy.hierarchyLevel1,\n                              hierarchy2: h.hierarchy.hierarchyLevel2,\n                              hierarchy3: h.hierarchy.hierarchyLevel3,\n                              hierarchy4: h.hierarchy.hierarchyLevel4\n                            })\n                          })\n                        }\n                      }\n                    )\n                  }\n                })\n            }\n          }\n        )\n      })\n  }\n  addParamValues() {\n    var paramValues = this.state.paramValues\n    paramValues.push(0)\n    this.setState({ paramValues })\n  }\n  setParamActiveIndex(index) {\n    var paramValues = this.state.paramValues\n    if (index === -1) {\n      var optimumPromoValue = this.state.optimumPromoValue\n      this.setState({\n        paramActiveIndex: index,\n        selectedPromoValue: optimumPromoValue\n      })\n    } else\n      this.setState({\n        paramActiveIndex: index,\n        selectedPromoValue: paramValues[index]\n      })\n  }\n  editParamValues(index, value) {\n    var paramValues = this.state.paramValues\n    paramValues[index] = value\n    if (this.state.paramActiveIndex === index)\n      this.setState({ paramValues, selectedPromoValue: value })\n    else this.setState({ paramValues })\n  }\n  editOptimumPromoValue(value) {\n    this.setState({ optimumPromoValue: value })\n  }\n  suggestPromoValue(value) {\n    if (!this.optimumPromoValueSet) {\n      this.setState({ optimumPromoValue: value })\n      this.optimumPromoValueSet = true\n    }\n    this.setState({ showSuggestModal: false })\n  }\n  render() {\n    var basicInfoFlag = false\n    var skuGroupFlag = false\n    if (\n      this.state.offerName &&\n      this.state.offerName.trim() !== '' &&\n      this.state.offerType &&\n      this.state.event &&\n      this.state.promoStartDate &&\n      this.state.promoEndDate\n    ) {\n      basicInfoFlag = true\n    }\n    if (this.state.categories && this.state.categories.length > 0) {\n      skuGroupFlag = true\n    }\n    return (\n      <div className=\"card div-main-createpromo\">\n        <CustomSuggestModal\n          showModal={this.state.showSuggestModal}\n          openModal={this.openModal.bind(this)}\n          closeModal={this.closeModal.bind(this)}\n          categories={this.state.categories}\n          suggestPromoValue={this.suggestPromoValue.bind(this)}\n          startDate={this.state.promoStartDate}\n          endDate={this.state.promoEndDate}\n        />\n        <ToastContainer\n          enableMultiContainer\n          containerId={'TOP_RIGHT_TOAST'}\n          position={toast.POSITION.TOP_RIGHT}\n        />\n        <div className=\"div-brdcrmb-createpromo\">\n          <h4 className=\"font-size-14\">\n            Create Promotion /{' '}\n            <span className=\"font-bold color-blue\"> Create Manually</span>\n          </h4>\n        </div>\n        <hr className=\"horizontal-createpromo\" />\n        <div className=\"create-promo-sub\">\n          <BasicInfo\n            {...this.state}\n            offerTypeOptions={OFFER_TYPE_OPTIONS}\n            channels={CHANNELS_LIST}\n            handleSelectChange={this.handleSelectChange}\n            handleInputChange={this.handleInputChange}\n            handleDateChange={this.handleDateChange}\n            handleCheckChange={this.handleCheckChange}\n            campaignsList={this.state.campaignsList}\n          />\n          <div className=\"mt-3\" />\n          <AddCategories\n            skuGroupColDefs={skuGroupColDefs}\n            handleSelectChange={this.handleSelectChange}\n            addCategory={this.addCategory}\n            hierarchy1={this.state.hierarchy1}\n            hierarchy2={this.state.hierarchy2}\n            hierarchy3={this.state.hierarchy3}\n            hierarchy4={this.state.hierarchy4}\n            categories={this.state.categories}\n            historicalCategories={this.state.historicalCategories}\n            validationFlag={basicInfoFlag}\n          />\n          <div className=\"mt-3\" />\n          {/* <Parameters\n              promoValues={this.state.promoValues}\n              addPromoValue={this.addPromoValue}\n              promoType={this.state.offerType}\n              optimumPromoValue={this.state.optimumPromoValue}\n              changePromoValue={this.changePromoValue}\n              selectedPromoValue={this.state.selectedPromoValue}\n            /> */}\n          <Parameters\n            paramValues={this.state.paramValues}\n            paramActiveIndex={this.state.paramActiveIndex}\n            addParamValues={this.addParamValues.bind(this)}\n            editParamValues={this.editParamValues.bind(this)}\n            setParamActiveIndex={this.setParamActiveIndex.bind(this)}\n            promoType={this.state.offerType}\n            optimumPromoValue={this.state.optimumPromoValue}\n            editOptimumPromoValue={this.editOptimumPromoValue.bind(this)}\n            suggestParamValue={this.openModal.bind(this)}\n            categories={this.state.categories}\n          />\n        </div>\n        <hr className=\"dotted-line\" />\n        <ButtonToolbar className=\"mt-3 j-c-c\">\n          <Button\n            variant=\"primary\"\n            onClick={this.simulatePromo}\n            disabled={!basicInfoFlag || !skuGroupFlag}\n          >\n            Simulate Promotion\n          </Button>\n          <Button\n            className=\"ml-2\"\n            variant=\"primary\"\n            onClick={this.savePromo}\n            disabled={!basicInfoFlag || !skuGroupFlag}\n          >\n            Save Promotion\n          </Button>\n        </ButtonToolbar>\n        {!!Object.keys(this.state.simulationResults).length && (\n          <PromoSimulation\n            simulationResults={cloneDeep(this.state.simulationResults)}\n          />\n        )}\n      </div>\n    )\n  }\n}\n\nexport default PromoCreation\n"]},"metadata":{},"sourceType":"module"}