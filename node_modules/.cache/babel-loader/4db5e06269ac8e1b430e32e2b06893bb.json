{"ast":null,"code":"import _classCallCheck from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/user/generic-markdown-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/user/generic-markdown-frontend/src/PricingModule/Container/EarlyWarningSystem.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\"; // import { AllCommunityModules } from \"ag-grid-community/all-modules\";\n\nimport { AgGridReact } from \"ag-grid-react\";\nimport _ from \"underscore\";\nimport EarlyWarningSystemColDef from \"../../PricingModule/TableColdefs/EarlyWarningSystemColDef\";\nimport { Table } from \"react-bootstrap\"; // import {AllCommunityModules} from '@ag-grid-community/all-modules';\n\nimport { fetchEarlyWarningTableData as _fetchEarlyWarningTableData } from '../Actions/EarlyWarningSystemAction';\nimport { getPricingFactorData as _getPricingFactorData } from '../Actions/PricingAction';\nimport Linechart from '../../components/support/Charts/LineChart';\nimport EarlyWarningModal from \"../Component/EarlyWarningModal\";\nimport AlertDanger from '../../utils/AlertMessage/alertDanger';\nimport { isEqual } from \"date-fns\"; // import _ from \"lodash\"\n\nimport PageLoader from \"../../utils/Loader\";\nexport var EarlyWarningSystem =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(EarlyWarningSystem, _Component);\n\n  function EarlyWarningSystem(props) {\n    var _this;\n\n    _classCallCheck(this, EarlyWarningSystem);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EarlyWarningSystem).call(this, props)); // this.getHeader = this.getHeader.bind(this);\n    // this.getRowsData = this.getRowsData.bind(this);\n    // this.getKeys = this.getKeys.bind(this);\n\n    _this.handleCompetitionCurve = function () {\n      console.log('Competition vs Demand curve working');\n\n      _this.setState({\n        competitionVsDemandCurveActive: true\n      }); // this.props.simulatePreSeasonMarkDown({});\n\n    };\n\n    _this.handleDemandCurve = function () {\n      console.log('Competition vs Demand curve working');\n\n      _this.setState({\n        competitionVsDemandCurveActive: false\n      }); // this.props.simulatePreSeasonMarkDown({});\n\n    };\n\n    _this.showLineModal = function (sku_id) {\n      _this.props.getPricingFactorData(\"skuid=\" + sku_id);\n\n      setTimeout(function () {\n        _this.setState({\n          showModalFlag: true,\n          dataLoading: false,\n          selectedSku: sku_id\n        });\n      }, 2000);\n\n      _this.setState({\n        dataLoading: true\n      });\n    };\n\n    _this.hideLineModal = function () {\n      _this.setState({\n        showModalFlag: false,\n        dataLoading: false,\n        selectedSku: null\n      });\n    };\n\n    _this.hideLineModalAlert = function () {\n      _this.setState({\n        selectedSku: null\n      });\n    };\n\n    _this.calculate = function () {};\n\n    _this.state = {\n      competitionVsDemandCurveActive: false,\n      earlyWarningData: [],\n      showModalFlag: false,\n      loader: false,\n      dataLoading: false,\n      selectedSku: null // columnDefs: [{\n      //     headerName: \"Product Name\", field: \"product-name\"\n      //   }, {\n      //     headerName: \"Current Price\", field: \"current-price\"\n      //   }, {\n      //     headerName: \"Last week Price Own\", field: \"last-week-price-own\"\n      //   }, {\n      //     headerName: \"Competitor Name\", field: \"competitor-name\"\n      //   }, {\n      //     headerName: \"Competitor Current Price\", field: \"competitor-current-price\"\n      //   }, {\n      //     headerName: \"Change Over Last Week Price\", field: \"change-over-last-week-price\"\n      //   }, {\n      //     headerName: \"Last Price Change Date\", field: \"last-price-change-date\"\n      //   }],\n      //   rowData: [{\n      //     make: \"Toyota\", model: \"Celica\", price: 35000\n      //   }, {\n      //     make: \"Ford\", model: \"Mondeo\", price: 32000\n      //   }, {\n      //     make: \"Porsche\", model: \"Boxter\", price: 72000\n      //   }]\n\n    };\n    return _this;\n  }\n\n  _createClass(EarlyWarningSystem, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.fetchEarlyWarningTableData(); //this.setState({ loader: true})\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (!_.isEqual(prevProps, this.props)) {\n        // console.log('componentDidUpdate~prevProps:',prevProps)\n        // console.log('componentDidUpdate~props:',this.props)\n        if (this.props.factorData !== undefined && prevProps.earlyData && prevProps.earlyData.earlyWarningData && prevProps.earlyData.earlyWarningData.length) {\n          this.setState({\n            showModalFlag: true,\n            dataLoading: false\n          });\n        }\n      }\n    }\n  }, {\n    key: \"render\",\n    // getKeys = function(){\n    //     console.log('Keys: ' , this.props.data);        \n    //     return Object.keys(this.props.data[0]);\n    //     }\n    //get header data\n    // getHeader = function(){\n    // }\n    //to get the rows for tbody\n    // getRowsData = function(){\n    //     var items = this.props.data;\n    //     var keys = this.getKeys();\n    //     return items.map((row, index)=>{\n    //     return <tr key={index}><RenderRow key={index} data={row} keys={keys}/></tr>\n    //     })\n    //     }123\n    value: function render() {\n      var _this2 = this;\n\n      var earlyWarningData = this.props.earlyData.earlyWarningData || [];\n\n      var groupedData = _.groupBy(earlyWarningData, \"sku_id\");\n\n      console.log('Early warning data', earlyWarningData);\n      console.log('Early warning grouped data', groupedData);\n      console.log('----------Early warning data-------------', this.props.earlyWarningMapData);\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(PageLoader, {\n        loader: this.state.dataLoading,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, React.createElement(\"h4\", {\n        className: \"promoCal-brdcrm mb-10\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, \"Pricing /\", \" \", React.createElement(\"span\", {\n        className: \"font-bold color-blue\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, \"Early Warning System\")), React.createElement(\"h8\", {\n        className: \"font-bold color-blue\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \"Competition\"), React.createElement(\"div\", {\n        classname: \"competition-vs-demand-toggle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-md-3 \",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"col-md-3 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"col-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"col-md-9\",\n        style: {\n          marginLeft: \"-29px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      })))), React.createElement(\"div\", {\n        className: \"ag-theme-balham competition-vs-demand-table\",\n        style: {\n          marginTop: '20px',\n          padding: '10px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(Table, {\n        bordered: true,\n        responsive: \"sm\",\n        className: \"some-table\",\n        style: {\n          border: '1px solid #d9dcde'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 196\n        },\n        __self: this\n      }, \"Product Name\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197\n        },\n        __self: this\n      }, \"Curent Price\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, \"Last Week Price Own\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, \"Competitior Name\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, \"Competitor Current Price\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, \"Change over last week price\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, \"Last price change date\"))), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, earlyWarningData.map(function (it, ind) {\n        var cal = (it.last_week_price - it.competitor_price) / it.last_week_price * 100;\n        var condition = cal < -20 || cal > 20;\n        return React.createElement(\"tr\", {\n          className: \"color-change\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212\n          },\n          __self: this\n        }, ind != 0 && earlyWarningData[ind].sku_id == earlyWarningData[ind - 1].sku_id ? null : React.createElement(\"td\", {\n          className: \"vertical-align-item\",\n          rowSpan: groupedData[it.sku_id].length,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 214\n          },\n          __self: this\n        }, it.sku_id, React.createElement(\"i\", {\n          class: \"fa fa-bar-chart\",\n          \"aria-hidden\": \"false\",\n          style: {\n            cursor: \"pointer\",\n            paddingLeft: \"6px\"\n          },\n          onClick: function onClick() {\n            return _this2.showLineModal(it.sku_id);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        })), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219\n          },\n          __self: this\n        }, it.current_price), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220\n          },\n          __self: this\n        }, it.last_week_price), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221\n          },\n          __self: this\n        }, it.competitor_name), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222\n          },\n          __self: this\n        }, it.competitor_price), React.createElement(\"td\", {\n          style: {\n            backgroundColor: condition ? \"#F8ECEB\" : \"inherit\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 223\n          },\n          __self: this\n        }, cal.toFixed(2) + '%'), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225\n          },\n          __self: this\n        }, \" \", it.last_price_change_date));\n      })))), !!this.state.showModalFlag && this.props.factorData && this.props.factorData.data && this.props.factorData.data.overall ? React.createElement(EarlyWarningModal, {\n        selectedSku: this.state.selectedSku,\n        showModal: this.state.showModalFlag,\n        hideModal: function hideModal() {\n          return _this2.hideLineModal();\n        },\n        hideModalAlert: function hideModalAlert() {\n          return _this2.hideLineModalAlert();\n        },\n        data: this.props.factorData,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }) : null));\n    }\n  }]);\n\n  return EarlyWarningSystem;\n}(Component); // const RenderRow = (props) =>{\n//     return props.keys.map((key, index)=>{\n//     return <td key={props.data[key]}>{props.data[key]}</td>\n//     })\n//    }\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    earlyData: state.earlyWarningData,\n    factorData: state.priceReducer.factorData\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    fetchEarlyWarningTableData: function fetchEarlyWarningTableData() {\n      return dispatch(_fetchEarlyWarningTableData());\n    },\n    getPricingFactorData: function getPricingFactorData(val) {\n      return dispatch(_getPricingFactorData(val));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(EarlyWarningSystem));","map":{"version":3,"sources":["/home/user/generic-markdown-frontend/src/PricingModule/Container/EarlyWarningSystem.js"],"names":["React","Component","connect","withRouter","AgGridReact","_","EarlyWarningSystemColDef","Table","fetchEarlyWarningTableData","getPricingFactorData","Linechart","EarlyWarningModal","AlertDanger","isEqual","PageLoader","EarlyWarningSystem","props","handleCompetitionCurve","console","log","setState","competitionVsDemandCurveActive","handleDemandCurve","showLineModal","sku_id","setTimeout","showModalFlag","dataLoading","selectedSku","hideLineModal","hideLineModalAlert","calculate","state","earlyWarningData","loader","prevProps","factorData","undefined","earlyData","length","groupedData","groupBy","earlyWarningMapData","marginLeft","marginTop","padding","border","map","it","ind","cal","last_week_price","competitor_price","condition","cursor","paddingLeft","current_price","competitor_name","backgroundColor","toFixed","last_price_change_date","data","overall","mapStateToProps","priceReducer","mapDispatchToProps","dispatch","val"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\n// import { AllCommunityModules } from \"ag-grid-community/all-modules\";\nimport { AgGridReact } from \"ag-grid-react\";\nimport _ from \"underscore\";\nimport EarlyWarningSystemColDef from \"../../PricingModule/TableColdefs/EarlyWarningSystemColDef\"\nimport { Table } from \"react-bootstrap\";\n// import {AllCommunityModules} from '@ag-grid-community/all-modules';\nimport { fetchEarlyWarningTableData } from '../Actions/EarlyWarningSystemAction'\nimport { getPricingFactorData } from '../Actions/PricingAction'\nimport Linechart from '../../components/support/Charts/LineChart'\nimport EarlyWarningModal from \"../Component/EarlyWarningModal\";\nimport AlertDanger from '../../utils/AlertMessage/alertDanger'\nimport { isEqual } from \"date-fns\";\n// import _ from \"lodash\"\nimport PageLoader from \"../../utils/Loader\"\n\n\nexport class EarlyWarningSystem extends Component {\n    constructor(props) {\n        super(props)\n        // this.getHeader = this.getHeader.bind(this);\n        // this.getRowsData = this.getRowsData.bind(this);\n        // this.getKeys = this.getKeys.bind(this);\n        this.state = {\n            competitionVsDemandCurveActive: false,\n            earlyWarningData: [],\n            showModalFlag: false,\n            loader: false,\n            dataLoading: false,\n            selectedSku: null\n            // columnDefs: [{\n            //     headerName: \"Product Name\", field: \"product-name\"\n            //   }, {\n            //     headerName: \"Current Price\", field: \"current-price\"\n            //   }, {\n            //     headerName: \"Last week Price Own\", field: \"last-week-price-own\"\n            //   }, {\n            //     headerName: \"Competitor Name\", field: \"competitor-name\"\n            //   }, {\n            //     headerName: \"Competitor Current Price\", field: \"competitor-current-price\"\n            //   }, {\n            //     headerName: \"Change Over Last Week Price\", field: \"change-over-last-week-price\"\n            //   }, {\n            //     headerName: \"Last Price Change Date\", field: \"last-price-change-date\"\n            //   }],\n            //   rowData: [{\n            //     make: \"Toyota\", model: \"Celica\", price: 35000\n            //   }, {\n            //     make: \"Ford\", model: \"Mondeo\", price: 32000\n            //   }, {\n            //     make: \"Porsche\", model: \"Boxter\", price: 72000\n            //   }]\n        }\n    }\n\n    componentDidMount() {\n        this.props.fetchEarlyWarningTableData()\n        //this.setState({ loader: true})\n\n\n    }\n\n    componentDidUpdate(prevProps) {\n        if (!_.isEqual(prevProps, this.props)) {\n            // console.log('componentDidUpdate~prevProps:',prevProps)\n            // console.log('componentDidUpdate~props:',this.props)\n            if (this.props.factorData !== undefined && prevProps.earlyData\n                && prevProps.earlyData.earlyWarningData && prevProps.earlyData.earlyWarningData.length) {\n                this.setState({\n                    showModalFlag: true,\n                    dataLoading: false\n                })\n            }\n        }\n    }\n    handleCompetitionCurve = () => {\n        console.log('Competition vs Demand curve working')\n        this.setState({\n            competitionVsDemandCurveActive: true,\n        })\n        // this.props.simulatePreSeasonMarkDown({});\n    }\n    handleDemandCurve = () => {\n        console.log('Competition vs Demand curve working')\n        this.setState({\n            competitionVsDemandCurveActive: false,\n        })\n        // this.props.simulatePreSeasonMarkDown({});\n    }\n\n\n\n    showLineModal = (sku_id) => {\n        this.props.getPricingFactorData(\"skuid=\" + sku_id)\n        setTimeout(() => {\n            this.setState({\n                showModalFlag: true,\n                dataLoading: false,\n                selectedSku: sku_id\n            })\n        }, 2000);\n        this.setState({\n            dataLoading: true\n        })\n    }\n    hideLineModal = () => {\n        this.setState({\n            showModalFlag: false,\n            dataLoading: false,\n            selectedSku: null\n        })\n    }\n\n    hideLineModalAlert = () => {\n        this.setState({\n            selectedSku: null\n        })\n    }\n    calculate = () => {\n\n    }\n\n\n    // getKeys = function(){\n    //     console.log('Keys: ' , this.props.data);        \n    //     return Object.keys(this.props.data[0]);\n    //     }\n\n    //get header data\n    // getHeader = function(){\n\n    // }\n\n    //to get the rows for tbody\n    // getRowsData = function(){\n    //     var items = this.props.data;\n    //     var keys = this.getKeys();\n    //     return items.map((row, index)=>{\n    //     return <tr key={index}><RenderRow key={index} data={row} keys={keys}/></tr>\n    //     })\n    //     }123\n    render() {\n        var earlyWarningData = this.props.earlyData.earlyWarningData || [];\n        var groupedData = _.groupBy(earlyWarningData, \"sku_id\")\n        console.log('Early warning data', earlyWarningData);\n        console.log('Early warning grouped data', groupedData);\n        console.log('----------Early warning data-------------', this.props.earlyWarningMapData);\n\n\n        return (\n            <div>\n                <PageLoader loader={this.state.dataLoading}>\n                    <h4 className=\"promoCal-brdcrm mb-10\">\n                        Pricing /{\" \"}\n                        <span className=\"font-bold color-blue\">Early Warning System</span>\n                    </h4>\n                    <h8 className=\"font-bold color-blue\">Competition</h8>\n                    <div classname=\"competition-vs-demand-toggle\">\n                        <div className=\"row\">\n                            <div className=\"col-md-3 \">\n                                <div className=\"col-md-3\" />\n                                <div className=\"col-md-3 text-center\">\n                                </div>\n                                <div className=\"col-md-3\">\n                                    {/* <div className=\"btn-group height-btngrp\">\n                                    <button className={`btn btn-outline-primary btnModal1 ${this.state.competitionVsDemandCurveActive ? \"active\" : \"\"}`}\n                                        onClick={() => this.handleCompetitionCurve()}>Competition</button>\n                                    <button\n                                        className={`btn btn-outline-primary btnModal1 ${!this.state.competitionVsDemandCurveActive ? \"active\" : \"\"}`}\n                                        onClick={() => this.handleDemandCurve()}\n                                    > Demand</button>\n                                </div> */}\n                                </div>\n                            </div>\n                            <div className=\"row\">\n                                <div className=\"col-md-3\" />\n                                <div className=\"col-md-9\" style={{ marginLeft: \"-29px\" }} />\n                            </div>\n                        </div>\n\n                    </div>\n                    <div className=\"ag-theme-balham competition-vs-demand-table\" style={{ marginTop: '20px', padding: '10px' }}>\n                        {/* <AgGridReact\n                    columnDefs={EarlyWarningSystemColDef.columnDefs}\n                    rowData={EarlyWarningSystemColDef.rowData}\n                    // rowSelection=\"multiple\"\n                    suppressRowTransform={true}\n                    // modules={AllCommunityModules}\n                >\n                </AgGridReact> */}\n                        <Table bordered responsive=\"sm\" className=\"some-table\" style={{ border: '1px solid #d9dcde' }}>\n                            <thead>\n                                <tr>\n                                    <th>Product Name</th>\n                                    <th>Curent Price</th>\n                                    <th>Last Week Price Own</th>\n                                    <th>Competitior Name</th>\n                                    <th>Competitor Current Price</th>\n                                    <th>Change over last week price</th>\n                                    <th>Last price change date</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                {\n                                    earlyWarningData.map((it, ind) => {\n                                        var cal = (((it.last_week_price - it.competitor_price) / it.last_week_price) * 100);\n                                        const condition = (cal < -20 || cal > 20);\n\n                                        return (\n                                            < tr className=\"color-change\">\n                                                {(ind != 0 && earlyWarningData[ind].sku_id == earlyWarningData[ind - 1].sku_id) ? null :\n                                                    <td className=\"vertical-align-item\" rowSpan={groupedData[it.sku_id].length}>{it.sku_id}\n                                                        <i class=\"fa fa-bar-chart\" aria-hidden=\"false\" style={{ cursor: \"pointer\", paddingLeft: \"6px\" }}\n                                                            onClick={() => this.showLineModal(it.sku_id)}></i></td>\n                                                }\n\n                                                <td>{it.current_price}</td>\n                                                <td>{it.last_week_price}</td>\n                                                <td>{it.competitor_name}</td>\n                                                <td>{it.competitor_price}</td>\n                                                <td style={{ backgroundColor: condition ? \"#F8ECEB\" : \"inherit\" }}>{cal.toFixed(2) + '%'}</td>\n                                                {/* <td>{it.change_over_lastweek}</td> */}\n                                                <td> {it.last_price_change_date}</td>\n                                            </tr>\n                                        )\n\n                                    })\n                                }\n                            </tbody>\n                        </Table>\n\n                    </div>\n                    {/*(this.props.factorData && this.props.factorData.data && this.props.factorData.data.overall.length>0)  ?\n                    <EarlyWarningModal\n                    showModal={this.state.showModalFlag}\n                    hideModal={() => this.hideLineModal()}\n                    data={this.props.factorData}\n                    />:\n                    ((this.props.factorData && this.props.factorData.data && this.props.factorData.data.overall.length==0)?\n                        <div className=\"alertDivs\">\n                         <AlertDanger autoClose={true} message={\"No data found\"}/></div> :null)\n                }\n                    />:(this.props.factorData && this.props.factorData.data && this.props.factorData.data.overall.length==0)?\n                    <div className=\"alertDivs\"><AlertDanger message={\"No data found\"}/></div>:null\n            \n                */}\n\n                    {\n                        (!!this.state.showModalFlag && this.props.factorData && this.props.factorData.data && this.props.factorData.data.overall) ?\n                            <EarlyWarningModal\n                                selectedSku={this.state.selectedSku}\n                                showModal={this.state.showModalFlag}\n                                hideModal={() => this.hideLineModal()}\n                                hideModalAlert={() => this.hideLineModalAlert()}\n                                data={this.props.factorData}\n                            /> : null\n\n                    }\n                </PageLoader >\n\n\n            </div >\n\n        )\n    }\n\n\n}\n// const RenderRow = (props) =>{\n//     return props.keys.map((key, index)=>{\n//     return <td key={props.data[key]}>{props.data[key]}</td>\n//     })\n//    }\n\n\nconst mapStateToProps = state => {\n    return {\n        earlyData: state.earlyWarningData,\n        factorData: state.priceReducer.factorData\n    }\n}\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        fetchEarlyWarningTableData: () => dispatch(fetchEarlyWarningTableData()),\n        getPricingFactorData: (val) => dispatch(getPricingFactorData(val))\n    }\n}\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(withRouter(EarlyWarningSystem))"]},"metadata":{},"sourceType":"module"}